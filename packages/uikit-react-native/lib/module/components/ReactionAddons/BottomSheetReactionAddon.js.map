{"version":3,"names":["React","Pressable","View","useSafeAreaInsets","useChannelHandler","Icon","Image","createStyleSheet","useUIKitTheme","useUniqHandlerId","UNKNOWN_USER_ID","useReaction","useSendbirdChat","BottomSheetReactionAddon","_ref","onClose","message","channel","emojiManager","currentUser","sdk","updateReactionFocusedItem","openReactionList","colors","handlerId","left","right","onReactionUpdated","eventChannel","event","url","messageId","msg","getMessage","includeReactions","channelUrl","channelType","emojiAll","allEmoji","slice","color","ui","reaction","default","createElement","style","styles","container","marginRight","marginLeft","map","_ref2","_message$reactions","_message$reactions$fi","key","reactionUserIds","reactions","find","it","userIds","currentUserIdx","indexOf","userId","reacted","onPress","deleteReaction","addReaction","_ref3","pressed","button","backgroundColor","selected","background","enabled","source","uri","emoji","_ref4","icon","onBackground03","paddingTop","paddingBottom","paddingHorizontal","flexDirection","justifyContent","width","height","padding","borderRadius"],"sources":["BottomSheetReactionAddon.tsx"],"sourcesContent":["import React from 'react';\nimport { Pressable, View } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\n\nimport type { BaseMessage } from '@sendbird/chat/message';\nimport { useChannelHandler } from '@sendbird/uikit-chat-hooks';\nimport { Icon, Image, createStyleSheet, useUIKitTheme } from '@sendbird/uikit-react-native-foundation';\nimport { SendbirdBaseChannel, SendbirdBaseMessage, useUniqHandlerId } from '@sendbird/uikit-utils';\n\nimport { UNKNOWN_USER_ID } from '../../constants';\nimport { useReaction, useSendbirdChat } from '../../hooks/useContext';\n\ntype Props = {\n  onClose: () => Promise<void>;\n  channel: SendbirdBaseChannel;\n  message: SendbirdBaseMessage;\n};\nconst BottomSheetReactionAddon = ({ onClose, message, channel }: Props) => {\n  const { emojiManager, currentUser, sdk } = useSendbirdChat();\n  const { updateReactionFocusedItem, openReactionList } = useReaction();\n  const { colors } = useUIKitTheme();\n  const handlerId = useUniqHandlerId('BottomSheetReactionAddon');\n  const { left, right } = useSafeAreaInsets();\n\n  useChannelHandler(sdk, handlerId, {\n    async onReactionUpdated(eventChannel, event) {\n      if (channel?.url === eventChannel.url && event.messageId === message?.messageId) {\n        const msg = (await sdk.message.getMessage({\n          includeReactions: true,\n          messageId: message.messageId,\n          channelUrl: message.channelUrl,\n          channelType: message.channelType,\n        })) as null | BaseMessage;\n        if (msg) updateReactionFocusedItem({ message: msg });\n      }\n    },\n  });\n\n  const emojiAll = emojiManager.allEmoji.slice(0, 5);\n  const color = colors.ui.reaction.default;\n\n  return (\n    <View style={[styles.container, { marginRight: right, marginLeft: left }]}>\n      {emojiAll.map(({ key, url }) => {\n        const reactionUserIds = message?.reactions?.find((it) => it.key === key)?.userIds ?? [];\n        const currentUserIdx = reactionUserIds.indexOf(currentUser?.userId ?? UNKNOWN_USER_ID);\n        const reacted = currentUserIdx > -1;\n\n        const onPress = () => {\n          if (reacted) channel.deleteReaction(message, key);\n          else channel.addReaction(message, key);\n          onClose();\n        };\n\n        return (\n          <Pressable\n            key={key}\n            onPress={onPress}\n            style={({ pressed }) => [\n              styles.button,\n              { backgroundColor: reacted || pressed ? color.selected.background : color.enabled.background },\n            ]}\n          >\n            <Image source={{ uri: url }} style={styles.emoji} />\n          </Pressable>\n        );\n      })}\n\n      <Pressable\n        onPress={async () => {\n          await onClose();\n          openReactionList({ channel, message });\n        }}\n        style={({ pressed }) => [\n          styles.button,\n          { backgroundColor: pressed ? color.selected.background : color.enabled.background },\n        ]}\n      >\n        <Icon icon={'emoji-more'} style={styles.emoji} color={colors.onBackground03} />\n      </Pressable>\n    </View>\n  );\n};\n\nconst styles = createStyleSheet({\n  container: {\n    paddingTop: 12,\n    paddingBottom: 16,\n    paddingHorizontal: 18,\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n  },\n  button: {\n    width: 44,\n    height: 44,\n    padding: 4,\n    borderRadius: 8,\n  },\n  emoji: {\n    width: '100%',\n    height: '100%',\n  },\n});\n\nexport default BottomSheetReactionAddon;\n"],"mappings":"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"}