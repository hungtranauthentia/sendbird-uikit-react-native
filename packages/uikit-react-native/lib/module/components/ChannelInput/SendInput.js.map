{"version":3,"names":["React","forwardRef","TouchableOpacity","View","MentionType","MessageMetaArray","Icon","Modal","TextInput","createStyleSheet","useAlert","useBottomSheet","useToast","useUIKitTheme","Logger","useDeferredModalState","useIIFE","VOICE_MESSAGE_META_ARRAY_DURATION_KEY","VOICE_MESSAGE_META_ARRAY_MESSAGE_TYPE_KEY","useChannelInputItems","useLocalization","usePlatformService","useSendbirdChat","SBUUtils","SendInput","_ref","ref","style","VoiceMessageInput","MessageToReplyPreview","AttachmentsButton","onPressSendUserMessage","onPressSendFileMessage","text","onChangeText","onSelectionChange","mentionedUsers","inputDisabled","inputFrozen","inputMuted","channel","messageToReply","setMessageToReply","playerService","recorderService","mentionManager","sbOptions","STRINGS","openSheet","toast","onClose","onDismiss","visible","voiceMessageInputVisible","setVisible","setVoiceMessageInputVisible","messageReplyParams","groupChannel","uikit","isGroupChannel","replyType","parentMessageId","messageId","isReplyToChannel","messageMentionParams","enableMention","mentionType","USERS","mentionedUserIds","map","it","user","userId","mentionedMessageTemplate","textToMentionedMessageTemplate","onFailureToSend","error","show","TOAST","SEND_MSG_ERROR","sendUserMessage","message","catch","sendFileMessage","file","sendVoiceMessage","durationMills","USER_MUTED_ERROR","CHANNEL_FROZEN_ERROR","metaArrays","key","value","String","options","extension","sheetItems","getPlaceholder","LABELS","CHANNEL_INPUT_PLACEHOLDER_MUTED","CHANNEL_INPUT_PLACEHOLDER_DISABLED","CHANNEL_INPUT_PLACEHOLDER_REPLY","CHANNEL_INPUT_PLACEHOLDER_ACTIVE","voiceMessageEnabled","enableVoiceMessage","sendButtonVisible","Boolean","trim","createElement","styles","sendInputContainer","onPress","disabled","multiline","disableFullscreenUI","editable","placeholder","textToMentionedComponents","VoiceMessageButton","UserMessageSendButton","disableBackgroundClose","Promise","allSettled","reset","backgroundStyle","justifyContent","type","onSend","_ref2","duration","_ref3","alert","colors","onPressWithPermissionCheck","recorderGranted","requestPermission","title","DIALOG","ALERT_PERMISSIONS_TITLE","ALERT_PERMISSIONS_MESSAGE","PERMISSION_MICROPHONE","PERMISSION_APP_NAME","buttons","ALERT_PERMISSIONS_OK","openSettings","playerGranted","PERMISSION_DEVICE_STORAGE","color","ui","input","default","highlight","active","icon","size","containerStyle","sendIcon","_ref4","paddingVertical","paddingHorizontal","alignItems","flexDirection","marginLeft","padding"],"sources":["SendInput.tsx"],"sourcesContent":["import React, { forwardRef } from 'react';\nimport {\n  NativeSyntheticEvent,\n  TextInput as RNTextInput,\n  TextInputSelectionChangeEventData,\n  TouchableOpacity,\n  View,\n} from 'react-native';\n\nimport { MentionType, MessageMetaArray } from '@sendbird/chat/message';\nimport {\n  Icon,\n  Modal,\n  TextInput,\n  createStyleSheet,\n  useAlert,\n  useBottomSheet,\n  useToast,\n  useUIKitTheme,\n} from '@sendbird/uikit-react-native-foundation';\nimport { Logger, useDeferredModalState, useIIFE } from '@sendbird/uikit-utils';\n\nimport { VOICE_MESSAGE_META_ARRAY_DURATION_KEY, VOICE_MESSAGE_META_ARRAY_MESSAGE_TYPE_KEY } from '../../constants';\nimport { useChannelInputItems } from '../../hooks/useChannelInputItems';\nimport { useLocalization, usePlatformService, useSendbirdChat } from '../../hooks/useContext';\nimport SBUUtils from '../../libs/SBUUtils';\nimport type { FileType } from '../../platform/types';\nimport type { MentionedUser } from '../../types';\nimport type { ChannelInputProps } from './index';\n\ninterface SendInputProps extends ChannelInputProps {\n  text: string;\n  onChangeText: (val: string) => void;\n  onSelectionChange: (e: NativeSyntheticEvent<TextInputSelectionChangeEventData>) => void;\n  mentionedUsers: MentionedUser[];\n}\n\nconst SendInput = forwardRef<RNTextInput, SendInputProps>(function SendInput(\n  {\n    style,\n    VoiceMessageInput,\n    MessageToReplyPreview,\n    AttachmentsButton,\n    onPressSendUserMessage,\n    onPressSendFileMessage,\n    text,\n    onChangeText,\n    onSelectionChange,\n    mentionedUsers,\n    inputDisabled,\n    inputFrozen,\n    inputMuted,\n    channel,\n    messageToReply,\n    setMessageToReply,\n  },\n  ref,\n) {\n  const { playerService, recorderService } = usePlatformService();\n  const { mentionManager, sbOptions } = useSendbirdChat();\n  const { STRINGS } = useLocalization();\n  const { openSheet } = useBottomSheet();\n  const toast = useToast();\n\n  const {\n    onClose,\n    onDismiss,\n    visible: voiceMessageInputVisible,\n    setVisible: setVoiceMessageInputVisible,\n  } = useDeferredModalState();\n\n  const messageReplyParams = useIIFE(() => {\n    const { groupChannel } = sbOptions.uikit;\n    if (!channel.isGroupChannel() || groupChannel.channel.replyType === 'none' || !messageToReply) return {};\n    return {\n      parentMessageId: messageToReply.messageId,\n      isReplyToChannel: true,\n    };\n  });\n\n  const messageMentionParams = useIIFE(() => {\n    const { groupChannel } = sbOptions.uikit;\n    if (!channel.isGroupChannel() || !groupChannel.channel.enableMention) return {};\n    return {\n      mentionType: MentionType.USERS,\n      mentionedUserIds: mentionedUsers.map((it) => it.user.userId),\n      mentionedMessageTemplate: mentionManager.textToMentionedMessageTemplate(\n        text,\n        mentionedUsers,\n        groupChannel.channel.enableMention,\n      ),\n    };\n  });\n\n  const onFailureToSend = (error: Error) => {\n    toast.show(STRINGS.TOAST.SEND_MSG_ERROR, 'error');\n    Logger.error(STRINGS.TOAST.SEND_MSG_ERROR, error);\n  };\n\n  const sendUserMessage = () => {\n    onPressSendUserMessage({\n      message: text,\n      ...messageMentionParams,\n      ...messageReplyParams,\n    }).catch(onFailureToSend);\n\n    onChangeText('');\n    setMessageToReply?.();\n  };\n\n  const sendFileMessage = (file: FileType) => {\n    onPressSendFileMessage({\n      file,\n      ...messageReplyParams,\n    }).catch(onFailureToSend);\n\n    setMessageToReply?.();\n  };\n\n  const sendVoiceMessage = (file: FileType, durationMills: number) => {\n    if (inputMuted) {\n      toast.show(STRINGS.TOAST.USER_MUTED_ERROR, 'error');\n      Logger.error(STRINGS.TOAST.USER_MUTED_ERROR);\n    } else if (inputFrozen) {\n      toast.show(STRINGS.TOAST.CHANNEL_FROZEN_ERROR, 'error');\n      Logger.error(STRINGS.TOAST.CHANNEL_FROZEN_ERROR);\n    } else {\n      onPressSendFileMessage({\n        file,\n        metaArrays: [\n          new MessageMetaArray({\n            key: VOICE_MESSAGE_META_ARRAY_DURATION_KEY,\n            value: [String(durationMills)],\n          }),\n          new MessageMetaArray({\n            key: VOICE_MESSAGE_META_ARRAY_MESSAGE_TYPE_KEY,\n            value: [`voice/${recorderService.options.extension}`],\n          }),\n        ],\n        ...messageReplyParams,\n      }).catch(onFailureToSend);\n    }\n\n    onChangeText('');\n    setMessageToReply?.();\n  };\n\n  const sheetItems = useChannelInputItems(channel, sendFileMessage);\n\n  const getPlaceholder = () => {\n    if (inputMuted) return STRINGS.LABELS.CHANNEL_INPUT_PLACEHOLDER_MUTED;\n    if (inputFrozen) return STRINGS.LABELS.CHANNEL_INPUT_PLACEHOLDER_DISABLED;\n    if (inputDisabled) return STRINGS.LABELS.CHANNEL_INPUT_PLACEHOLDER_DISABLED;\n    if (messageToReply) return STRINGS.LABELS.CHANNEL_INPUT_PLACEHOLDER_REPLY;\n\n    return STRINGS.LABELS.CHANNEL_INPUT_PLACEHOLDER_ACTIVE;\n  };\n\n  const voiceMessageEnabled = channel.isGroupChannel() && sbOptions.uikit.groupChannel.channel.enableVoiceMessage;\n  const sendButtonVisible = Boolean(text.trim());\n\n  return (\n    <View>\n      {MessageToReplyPreview && (\n        <MessageToReplyPreview messageToReply={messageToReply} setMessageToReply={setMessageToReply} />\n      )}\n      <View style={styles.sendInputContainer}>\n        {AttachmentsButton && <AttachmentsButton onPress={() => openSheet({ sheetItems })} disabled={inputDisabled} />}\n        <TextInput\n          ref={ref}\n          multiline\n          disableFullscreenUI\n          onSelectionChange={onSelectionChange}\n          editable={!inputDisabled}\n          onChangeText={onChangeText}\n          style={style}\n          placeholder={getPlaceholder()}\n        >\n          {mentionManager.textToMentionedComponents(\n            text,\n            mentionedUsers,\n            sbOptions.uikit.groupChannel.channel.enableMention,\n          )}\n        </TextInput>\n\n        {voiceMessageEnabled && (\n          <VoiceMessageButton\n            visible={!sendButtonVisible}\n            disabled={inputDisabled}\n            onPress={() => setVoiceMessageInputVisible(true)}\n          />\n        )}\n        <UserMessageSendButton visible={sendButtonVisible} disabled={inputDisabled} onPress={sendUserMessage} />\n        {voiceMessageEnabled && VoiceMessageInput && (\n          <Modal\n            disableBackgroundClose\n            onClose={onClose}\n            onDismiss={() => {\n              onDismiss();\n              Promise.allSettled([playerService.reset(), recorderService.reset()]);\n            }}\n            backgroundStyle={{ justifyContent: 'flex-end' }}\n            visible={voiceMessageInputVisible}\n            type={'slide-no-gesture'}\n          >\n            <VoiceMessageInput onClose={onClose} onSend={({ file, duration }) => sendVoiceMessage(file, duration)} />\n          </Modal>\n        )}\n      </View>\n    </View>\n  );\n});\n\ntype InputButtonProps = { visible: boolean; disabled: boolean; onPress: () => void };\nconst VoiceMessageButton = ({ visible, disabled, onPress }: InputButtonProps) => {\n  const { STRINGS } = useLocalization();\n  const { alert } = useAlert();\n  const { playerService, recorderService } = usePlatformService();\n  const { colors } = useUIKitTheme();\n  if (!visible) return null;\n\n  const onPressWithPermissionCheck = async () => {\n    const recorderGranted = await recorderService.requestPermission();\n    if (!recorderGranted) {\n      alert({\n        title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n        message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n          STRINGS.LABELS.PERMISSION_MICROPHONE,\n          STRINGS.LABELS.PERMISSION_APP_NAME,\n        ),\n        buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n      });\n      Logger.error('Failed to request permission for recorder');\n      return;\n    }\n\n    const playerGranted = await playerService.requestPermission();\n    if (!playerGranted) {\n      alert({\n        title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n        message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n          STRINGS.LABELS.PERMISSION_DEVICE_STORAGE,\n          STRINGS.LABELS.PERMISSION_APP_NAME,\n        ),\n        buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n      });\n      Logger.error('Failed to request permission for player');\n      return;\n    }\n\n    onPress();\n  };\n\n  return (\n    <TouchableOpacity onPress={onPressWithPermissionCheck} disabled={disabled}>\n      <Icon\n        color={disabled ? colors.ui.input.default.disabled.highlight : colors.ui.input.default.active.highlight}\n        icon={'audio-on'}\n        size={24}\n        containerStyle={styles.sendIcon}\n      />\n    </TouchableOpacity>\n  );\n};\nconst UserMessageSendButton = ({ visible, disabled, onPress }: InputButtonProps) => {\n  const { colors } = useUIKitTheme();\n  if (!visible) return null;\n  return (\n    <TouchableOpacity onPress={onPress} disabled={disabled}>\n      <Icon\n        color={disabled ? colors.ui.input.default.disabled.highlight : colors.ui.input.default.active.highlight}\n        icon={'send'}\n        size={24}\n        containerStyle={styles.sendIcon}\n      />\n    </TouchableOpacity>\n  );\n};\n\nconst styles = createStyleSheet({\n  sendInputContainer: {\n    paddingVertical: 10,\n    paddingHorizontal: 12,\n    alignItems: 'center',\n    flexDirection: 'row',\n  },\n  sendIcon: {\n    marginLeft: 4,\n    padding: 4,\n  },\n});\n\nexport default SendInput;\n"],"mappings":"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"}