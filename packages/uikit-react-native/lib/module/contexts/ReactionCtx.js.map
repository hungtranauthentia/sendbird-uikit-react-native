{"version":3,"names":["React","useCallback","useContext","useReducer","useRef","useState","NOOP","ReactionBottomSheets","LocalizationContext","SendbirdChatContext","UserProfileContext","ReactionContext","createContext","ReactionProvider","_ref","children","onPressUserProfile","chatCtx","localizationCtx","userProfileCtx","Error","state","setState","prev","next","reactionListVisible","setReactionListVisible","reactionUserListVisible","setReactionUserListVisible","reactionUserListFocusIndex","setReactionUserListFocusIndex","closeResolver","openReactionList","params","openReactionUserList","_ref2","channel","message","focusIndex","isGroupChannel","isSuper","updateReactionFocusedItem","createOnCloseWithResolver","callback","Promise","resolve","current","reactionCtx","sheetProps","show","onDismiss","_closeResolver$curren","call","createElement","Provider","value","UserList","_extends","visible","onClose","ReactionList"],"sources":["ReactionCtx.tsx"],"sourcesContent":["import React, { useCallback, useContext, useReducer, useRef, useState } from 'react';\n\nimport type { SendbirdBaseChannel, SendbirdBaseMessage } from '@sendbird/uikit-utils';\nimport { NOOP } from '@sendbird/uikit-utils';\n\nimport { ReactionBottomSheetProps, ReactionBottomSheets } from '../components/ReactionBottomSheets';\nimport { LocalizationContext } from '../contexts/LocalizationCtx';\nimport { SendbirdChatContext } from '../contexts/SendbirdChatCtx';\nimport { UserProfileContext } from '../contexts/UserProfileCtx';\n\ntype State = {\n  message?: SendbirdBaseMessage;\n  channel?: SendbirdBaseChannel;\n};\nexport type ReactionContextType = {\n  openReactionList(param: Required<State>): void;\n  openReactionUserList(param: Required<State> & { focusIndex?: number }): void;\n  updateReactionFocusedItem(param?: State): void;\n  focusIndex: number;\n} & State;\n\ntype Props = React.PropsWithChildren<{\n  onPressUserProfile?: ReactionBottomSheetProps['onPressUserProfile'];\n}>;\n\nexport const ReactionContext = React.createContext<ReactionContextType | null>(null);\nexport const ReactionProvider = ({ children, onPressUserProfile }: Props) => {\n  const chatCtx = useContext(SendbirdChatContext);\n  const localizationCtx = useContext(LocalizationContext);\n  const userProfileCtx = useContext(UserProfileContext);\n  if (!chatCtx) throw new Error('SendbirdChatContext is not provided');\n  if (!localizationCtx) throw new Error('LocalizationContext is not provided');\n  if (!userProfileCtx) throw new Error('UserProfileContext is not provided');\n\n  const [state, setState] = useReducer((prev: State, next: State) => ({ ...prev, ...next }), {});\n  const [reactionListVisible, setReactionListVisible] = useState(false);\n  const [reactionUserListVisible, setReactionUserListVisible] = useState(false);\n  const [reactionUserListFocusIndex, setReactionUserListFocusIndex] = useState(0);\n\n  const closeResolver = useRef<() => void>(NOOP);\n\n  const openReactionList: ReactionContextType['openReactionList'] = useCallback((params) => {\n    setState(params);\n    setReactionListVisible(true);\n  }, []);\n\n  const openReactionUserList: ReactionContextType['openReactionUserList'] = useCallback(\n    ({ channel, message, focusIndex = 0 }) => {\n      // NOTE: We don't support reaction user list for supergroup channel\n      if (channel.isGroupChannel() && channel.isSuper) return;\n\n      setState({ channel, message });\n      setReactionUserListFocusIndex(focusIndex);\n      setReactionUserListVisible(true);\n    },\n    [],\n  );\n\n  const updateReactionFocusedItem: ReactionContextType['updateReactionFocusedItem'] = useCallback((params) => {\n    if (params) setState(params);\n    else setState({});\n  }, []);\n\n  const createOnCloseWithResolver = (callback: () => void) => {\n    return () => {\n      return new Promise<void>((resolve) => {\n        closeResolver.current = resolve;\n        callback();\n      });\n    };\n  };\n\n  const reactionCtx = {\n    ...state,\n    openReactionList,\n    openReactionUserList,\n    updateReactionFocusedItem,\n    focusIndex: reactionUserListFocusIndex,\n  };\n\n  const sheetProps: Omit<ReactionBottomSheetProps, 'visible' | 'onClose'> = {\n    chatCtx,\n    reactionCtx,\n    localizationCtx,\n    onPressUserProfile: onPressUserProfile ?? userProfileCtx.show,\n    onDismiss: () => {\n      setState({});\n      closeResolver.current?.();\n    },\n  };\n\n  return (\n    <ReactionContext.Provider value={reactionCtx}>\n      {children}\n      <ReactionBottomSheets.UserList\n        {...sheetProps}\n        visible={reactionUserListVisible}\n        onClose={createOnCloseWithResolver(() => setReactionUserListVisible(false))}\n      />\n      <ReactionBottomSheets.ReactionList\n        {...sheetProps}\n        visible={reactionListVisible}\n        onClose={createOnCloseWithResolver(() => setReactionListVisible(false))}\n      />\n    </ReactionContext.Provider>\n  );\n};\n"],"mappings":"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"}