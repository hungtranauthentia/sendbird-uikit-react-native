{"version":3,"names":["normalizeFile","expoBackwardUtils","imagePicker","isCanceled","result","canceled","cancelled","toFilePickerResponses","fsModule","assets","promises","map","_ref","fileName","name","fileSize","size","type","uri","Promise","all","fileInfo","getInfoAsync","response","toFileSize","documentPicker","_ref2","mimeType","info"],"sources":["expoBackwardUtils.ts"],"sourcesContent":["import type * as ExpoDocumentPicker from 'expo-document-picker';\nimport type * as ExpoFs from 'expo-file-system';\nimport type * as ExpoImagePicker from 'expo-image-picker';\n\nimport type { FilePickerResponse } from '../platform/types';\nimport normalizeFile from './normalizeFile';\n\nconst expoBackwardUtils = {\n  imagePicker: {\n    isCanceled(result: ExpoImagePicker.ImagePickerResult) {\n      // @ts-expect-error backward compatibility\n      return result.canceled ?? result.cancelled;\n    },\n    async toFilePickerResponses(\n      result: ExpoImagePicker.ImagePickerResult,\n      fsModule: typeof ExpoFs,\n    ): Promise<FilePickerResponse[]> {\n      if (result.assets) {\n        const assets = result.assets || [];\n        const promises = assets.map(({ fileName: name, fileSize: size, type, uri }) =>\n          normalizeFile({ uri, size, name, type }),\n        );\n\n        return Promise.all(promises);\n      } else if ('uri' in result && typeof result.uri === 'string') {\n        const fileInfo = await fsModule.getInfoAsync(result.uri);\n        const response = await normalizeFile({ uri: result.uri, size: expoBackwardUtils.toFileSize(fileInfo) });\n        return [response];\n      } else {\n        return [];\n      }\n    },\n  },\n  documentPicker: {\n    isCanceled(result: ExpoDocumentPicker.DocumentPickerResult) {\n      // @ts-expect-error backward compatibility\n      return result.canceled ?? result.type === 'cancel';\n    },\n    async toFilePickerResponses(result: ExpoDocumentPicker.DocumentPickerResult): Promise<FilePickerResponse[]> {\n      if (result.assets) {\n        const assets = result.assets || [];\n        const promises = assets.map(({ name, size, mimeType, uri }) =>\n          normalizeFile({ uri, size, name, type: mimeType }),\n        );\n\n        return Promise.all(promises);\n      } else if ('uri' in result && typeof result.uri === 'string') {\n        // @ts-expect-error backward compatibility\n        const { mimeType, uri, size, name } = result;\n        const response = await normalizeFile({ uri, size, name, type: mimeType });\n\n        return [response];\n      } else {\n        return [];\n      }\n    },\n  },\n  toFileSize(info: ExpoFs.FileInfo) {\n    if ('size' in info) {\n      return info.size;\n    } else {\n      return 0;\n    }\n  },\n};\n\nexport default expoBackwardUtils;\n"],"mappings":"AAKA,OAAOA,aAAa,MAAM,iBAAiB;AAE3C,MAAMC,iBAAiB,GAAG;EACxBC,WAAW,EAAE;IACXC,UAAUA,CAACC,MAAyC,EAAE;MACpD;MACA,OAAOA,MAAM,CAACC,QAAQ,IAAID,MAAM,CAACE,SAAS;IAC5C,CAAC;IACD,MAAMC,qBAAqBA,CACzBH,MAAyC,EACzCI,QAAuB,EACQ;MAC/B,IAAIJ,MAAM,CAACK,MAAM,EAAE;QACjB,MAAMA,MAAM,GAAGL,MAAM,CAACK,MAAM,IAAI,EAAE;QAClC,MAAMC,QAAQ,GAAGD,MAAM,CAACE,GAAG,CAACC,IAAA;UAAA,IAAC;YAAEC,QAAQ,EAAEC,IAAI;YAAEC,QAAQ,EAAEC,IAAI;YAAEC,IAAI;YAAEC;UAAI,CAAC,GAAAN,IAAA;UAAA,OACxEZ,aAAa,CAAC;YAAEkB,GAAG;YAAEF,IAAI;YAAEF,IAAI;YAAEG;UAAK,CAAC,CAAC;QAAA,EACzC;QAED,OAAOE,OAAO,CAACC,GAAG,CAACV,QAAQ,CAAC;MAC9B,CAAC,MAAM,IAAI,KAAK,IAAIN,MAAM,IAAI,OAAOA,MAAM,CAACc,GAAG,KAAK,QAAQ,EAAE;QAC5D,MAAMG,QAAQ,GAAG,MAAMb,QAAQ,CAACc,YAAY,CAAClB,MAAM,CAACc,GAAG,CAAC;QACxD,MAAMK,QAAQ,GAAG,MAAMvB,aAAa,CAAC;UAAEkB,GAAG,EAAEd,MAAM,CAACc,GAAG;UAAEF,IAAI,EAAEf,iBAAiB,CAACuB,UAAU,CAACH,QAAQ;QAAE,CAAC,CAAC;QACvG,OAAO,CAACE,QAAQ,CAAC;MACnB,CAAC,MAAM;QACL,OAAO,EAAE;MACX;IACF;EACF,CAAC;EACDE,cAAc,EAAE;IACdtB,UAAUA,CAACC,MAA+C,EAAE;MAC1D;MACA,OAAOA,MAAM,CAACC,QAAQ,IAAID,MAAM,CAACa,IAAI,KAAK,QAAQ;IACpD,CAAC;IACD,MAAMV,qBAAqBA,CAACH,MAA+C,EAAiC;MAC1G,IAAIA,MAAM,CAACK,MAAM,EAAE;QACjB,MAAMA,MAAM,GAAGL,MAAM,CAACK,MAAM,IAAI,EAAE;QAClC,MAAMC,QAAQ,GAAGD,MAAM,CAACE,GAAG,CAACe,KAAA;UAAA,IAAC;YAAEZ,IAAI;YAAEE,IAAI;YAAEW,QAAQ;YAAET;UAAI,CAAC,GAAAQ,KAAA;UAAA,OACxD1B,aAAa,CAAC;YAAEkB,GAAG;YAAEF,IAAI;YAAEF,IAAI;YAAEG,IAAI,EAAEU;UAAS,CAAC,CAAC;QAAA,EACnD;QAED,OAAOR,OAAO,CAACC,GAAG,CAACV,QAAQ,CAAC;MAC9B,CAAC,MAAM,IAAI,KAAK,IAAIN,MAAM,IAAI,OAAOA,MAAM,CAACc,GAAG,KAAK,QAAQ,EAAE;QAC5D;QACA,MAAM;UAAES,QAAQ;UAAET,GAAG;UAAEF,IAAI;UAAEF;QAAK,CAAC,GAAGV,MAAM;QAC5C,MAAMmB,QAAQ,GAAG,MAAMvB,aAAa,CAAC;UAAEkB,GAAG;UAAEF,IAAI;UAAEF,IAAI;UAAEG,IAAI,EAAEU;QAAS,CAAC,CAAC;QAEzE,OAAO,CAACJ,QAAQ,CAAC;MACnB,CAAC,MAAM;QACL,OAAO,EAAE;MACX;IACF;EACF,CAAC;EACDC,UAAUA,CAACI,IAAqB,EAAE;IAChC,IAAI,MAAM,IAAIA,IAAI,EAAE;MAClB,OAAOA,IAAI,CAACZ,IAAI;IAClB,CAAC,MAAM;MACL,OAAO,CAAC;IACV;EACF;AACF,CAAC;AAED,eAAef,iBAAiB"}