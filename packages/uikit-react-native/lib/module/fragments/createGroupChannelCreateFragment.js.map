{"version":3,"names":["React","TouchableOpacity","useUserList","PASS","getDefaultGroupChannelCreateParams","useFreshCallback","StatusComposition","UserSelectableBar","createUserListModule","useLocalization","useSendbirdChat","createGroupChannelCreateFragment","initModule","UserListModule","_ref","onPressHeaderLeft","onBeforeCreateChannel","onCreateChannel","sortComparator","queryCreator","channelType","renderUser","sdk","currentUser","STRINGS","users","refreshing","loading","error","refresh","next","_renderUser","user","selectedUsers","setSelectedUsers","hasRequiredKey","Error","isMe","userId","userIdx","findIndex","u","isSelected","createElement","activeOpacity","onPress","_ref2","draft","splice","push","uri","profileUrl","name","nickname","LABELS","USER_NO_NAME","selected","disabled","Provider","headerRight","GROUP_CHANNEL_CREATE","HEADER_RIGHT","headerTitle","HEADER_TITLE","Header","onPressHeaderRight","params","invitedUserIds","map","it","currentUserId","isBroadcast","isSuper","processedParams","channel","groupChannel","createChannel","Boolean","LoadingComponent","StatusLoading","ErrorComponent","StatusError","onPressRetry","List","onLoadNext","onRefresh","ListEmptyComponent","StatusEmpty"],"sources":["createGroupChannelCreateFragment.tsx"],"sourcesContent":["import React from 'react';\nimport { TouchableOpacity } from 'react-native';\n\nimport { useUserList } from '@sendbird/uikit-chat-hooks';\nimport {\n  PASS,\n  SendbirdUser,\n  UserStruct,\n  getDefaultGroupChannelCreateParams,\n  useFreshCallback,\n} from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserSelectableBar from '../components/UserSelectableBar';\nimport type { GroupChannelCreateFragment } from '../domain/groupChannelUserList/types';\nimport createUserListModule from '../domain/userList/module/createUserListModule';\nimport type { UserListModule } from '../domain/userList/types';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\nconst createGroupChannelCreateFragment = <UserType extends UserStruct>(\n  initModule?: Partial<UserListModule<UserType>>,\n): GroupChannelCreateFragment<UserType> => {\n  const UserListModule = createUserListModule<UserType>(initModule);\n\n  return ({\n    onPressHeaderLeft,\n    onBeforeCreateChannel = PASS,\n    onCreateChannel,\n    sortComparator,\n    queryCreator,\n    channelType = 'GROUP',\n    renderUser,\n  }) => {\n    const { sdk, currentUser } = useSendbirdChat();\n    const { STRINGS } = useLocalization();\n    const { users, refreshing, loading, error, refresh, next } = useUserList(sdk, {\n      queryCreator,\n      sortComparator,\n    });\n\n    const _renderUser: NonNullable<typeof renderUser> = useFreshCallback((user, selectedUsers, setSelectedUsers) => {\n      if (queryCreator && !renderUser) {\n        const hasRequiredKey = 'profileUrl' in user && 'nickname' in user;\n        if (!hasRequiredKey) throw new Error('You should provide \"renderUser\" when providing \"queryCreator\"');\n      }\n\n      if (renderUser) return renderUser(user, selectedUsers, setSelectedUsers);\n\n      const isMe = user.userId === currentUser?.userId;\n      if (isMe) return null;\n\n      const userIdx = selectedUsers.findIndex((u) => u.userId === user.userId);\n      const isSelected = userIdx > -1;\n\n      return (\n        <TouchableOpacity\n          activeOpacity={0.7}\n          onPress={() => {\n            setSelectedUsers(([...draft]) => {\n              if (isSelected) draft.splice(userIdx, 1);\n              else draft.push(user);\n              return draft;\n            });\n          }}\n        >\n          <UserSelectableBar\n            uri={(user as unknown as SendbirdUser).profileUrl}\n            name={(user as unknown as SendbirdUser).nickname || STRINGS.LABELS.USER_NO_NAME}\n            selected={isSelected}\n            disabled={false}\n          />\n        </TouchableOpacity>\n      );\n    });\n\n    return (\n      <UserListModule.Provider\n        headerRight={(selectedUsers) => STRINGS.GROUP_CHANNEL_CREATE.HEADER_RIGHT({ selectedUsers })}\n        headerTitle={STRINGS.GROUP_CHANNEL_CREATE.HEADER_TITLE}\n      >\n        <UserListModule.Header\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={async (users) => {\n            const params = getDefaultGroupChannelCreateParams({\n              invitedUserIds: users.map((it) => it.userId),\n              currentUserId: currentUser?.userId,\n            });\n\n            if (channelType === 'BROADCAST') params.isBroadcast = true;\n            if (channelType === 'SUPER_GROUP') params.isSuper = true;\n\n            const processedParams = await onBeforeCreateChannel(params, users);\n            const channel = await sdk.groupChannel.createChannel(processedParams);\n            onCreateChannel(channel);\n          }}\n        />\n        <StatusComposition\n          loading={loading}\n          error={Boolean(error)}\n          LoadingComponent={<UserListModule.StatusLoading />}\n          ErrorComponent={<UserListModule.StatusError onPressRetry={() => refresh()} />}\n        >\n          <UserListModule.List\n            onLoadNext={next}\n            users={users}\n            renderUser={_renderUser}\n            onRefresh={refresh}\n            refreshing={refreshing}\n            ListEmptyComponent={<UserListModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </UserListModule.Provider>\n    );\n  };\n};\n\nexport default createGroupChannelCreateFragment;\n"],"mappings":"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"}