{"version":3,"names":["React","useCallback","TouchableOpacity","useUserList","StatusComposition","UserSelectableBar","createUserListModule","useLocalization","useSendbirdChat","createOpenChannelRegisterOperatorFragment","initModule","UserListModule","_ref","channel","onPressHeaderLeft","sortComparator","renderUser","onPressHeaderRight","queryCreator","createParticipantListQuery","limit","sdk","currentUser","STRINGS","users","refreshing","refresh","next","error","loading","_renderUser","user","selectedUsers","setSelectedUsers","userIdx","findIndex","u","userId","isSelected","isOperator","createElement","activeOpacity","disabled","onPress","_ref2","draft","splice","push","uri","profileUrl","name","nickname","LABELS","USER_NO_NAME","USER_BAR_ME_POSTFIX","selected","Provider","headerRight","OPEN_CHANNEL_REGISTER_OPERATOR","HEADER_RIGHT","headerTitle","HEADER_TITLE","Header","shouldActivateHeaderRight","length","addOperators","map","it","Boolean","LoadingComponent","StatusLoading","ErrorComponent","StatusError","onPressRetry","List","onLoadNext","onRefresh","ListEmptyComponent","StatusEmpty"],"sources":["createOpenChannelRegisterOperatorFragment.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { TouchableOpacity } from 'react-native';\n\nimport { useUserList } from '@sendbird/uikit-chat-hooks';\nimport type { SendbirdParticipant } from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserSelectableBar from '../components/UserSelectableBar';\nimport type { OpenChannelRegisterOperatorFragment } from '../domain/openChannelUserList/types';\nimport createUserListModule from '../domain/userList/module/createUserListModule';\nimport type { UserListModule } from '../domain/userList/types';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\nconst createOpenChannelRegisterOperatorFragment = (\n  initModule?: Partial<UserListModule<SendbirdParticipant>>,\n): OpenChannelRegisterOperatorFragment => {\n  const UserListModule = createUserListModule<SendbirdParticipant>(initModule);\n\n  return ({\n    channel,\n    onPressHeaderLeft,\n    sortComparator,\n    renderUser,\n    onPressHeaderRight,\n    queryCreator = () => channel.createParticipantListQuery({ limit: 20 }),\n  }) => {\n    const { sdk, currentUser } = useSendbirdChat();\n    const { STRINGS } = useLocalization();\n    const { users, refreshing, refresh, next, error, loading } = useUserList(sdk, { queryCreator, sortComparator });\n\n    const _renderUser: NonNullable<typeof renderUser> = useCallback(\n      (user, selectedUsers, setSelectedUsers) => {\n        if (renderUser) return renderUser(user, selectedUsers, setSelectedUsers);\n\n        const userIdx = selectedUsers.findIndex((u) => u.userId === user.userId);\n        const isSelected = userIdx > -1;\n        const isOperator = channel.isOperator(user);\n\n        return (\n          <TouchableOpacity\n            activeOpacity={0.7}\n            disabled={isOperator}\n            onPress={() => {\n              setSelectedUsers(([...draft]) => {\n                if (isSelected) draft.splice(userIdx, 1);\n                else draft.push(user);\n                return draft;\n              });\n            }}\n          >\n            <UserSelectableBar\n              uri={user.profileUrl}\n              name={\n                (user.nickname || STRINGS.LABELS.USER_NO_NAME) +\n                (user.userId === currentUser?.userId ? STRINGS.LABELS.USER_BAR_ME_POSTFIX : '')\n              }\n              selected={isOperator || isSelected}\n              disabled={isOperator}\n            />\n          </TouchableOpacity>\n        );\n      },\n      [channel, renderUser],\n    );\n\n    return (\n      <UserListModule.Provider\n        headerRight={(selectedUsers) => STRINGS.OPEN_CHANNEL_REGISTER_OPERATOR.HEADER_RIGHT({ selectedUsers })}\n        headerTitle={STRINGS.OPEN_CHANNEL_REGISTER_OPERATOR.HEADER_TITLE}\n      >\n        <UserListModule.Header\n          shouldActivateHeaderRight={(selectedUsers) => selectedUsers.length > 0}\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={async (users) => {\n            await channel.addOperators(users.map((it) => it.userId));\n            onPressHeaderRight(channel);\n          }}\n        />\n        <StatusComposition\n          loading={loading}\n          error={Boolean(error)}\n          LoadingComponent={<UserListModule.StatusLoading />}\n          ErrorComponent={<UserListModule.StatusError onPressRetry={() => refresh()} />}\n        >\n          <UserListModule.List\n            onLoadNext={next}\n            users={users as SendbirdParticipant[]}\n            renderUser={_renderUser}\n            onRefresh={refresh}\n            refreshing={refreshing}\n            ListEmptyComponent={<UserListModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </UserListModule.Provider>\n    );\n  };\n};\n\nexport default createOpenChannelRegisterOperatorFragment;\n"],"mappings":"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"}