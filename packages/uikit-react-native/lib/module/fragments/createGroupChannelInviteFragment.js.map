{"version":3,"names":["React","useCallback","TouchableOpacity","useUserList","StatusComposition","UserSelectableBar","createUserListModule","useLocalization","useSendbirdChat","createGroupChannelInviteFragment","initModule","UserListModule","_ref","channel","onPressHeaderLeft","onInviteMembers","sortComparator","queryCreator","renderUser","sdk","STRINGS","users","refreshing","refresh","next","error","loading","memberIds","shouldFilterMember","members","map","it","userId","_renderUser","user","selectedUsers","setSelectedUsers","hasRequiredKey","Error","userIdxInMembers","indexOf","userIdxInSelectedUsers","findIndex","isMember","isSelected","createElement","activeOpacity","disabled","onPress","_ref2","draft","splice","push","uri","profileUrl","name","nickname","LABELS","USER_NO_NAME","selected","Provider","headerRight","GROUP_CHANNEL_INVITE","HEADER_RIGHT","headerTitle","HEADER_TITLE","Header","onPressHeaderRight","userIds","updatedChannel","inviteWithUserIds","Boolean","LoadingComponent","StatusLoading","ErrorComponent","StatusError","onPressRetry","List","onLoadNext","onRefresh","ListEmptyComponent","StatusEmpty","isSuper","isBroadcast"],"sources":["createGroupChannelInviteFragment.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { TouchableOpacity } from 'react-native';\n\nimport { useUserList } from '@sendbird/uikit-chat-hooks';\nimport type { SendbirdGroupChannel, SendbirdUser, UserStruct } from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserSelectableBar from '../components/UserSelectableBar';\nimport type { GroupChannelInviteFragment } from '../domain/groupChannelUserList/types';\nimport createUserListModule from '../domain/userList/module/createUserListModule';\nimport type { UserListModule } from '../domain/userList/types';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\nconst createGroupChannelInviteFragment = <UserType extends UserStruct>(\n  initModule?: Partial<UserListModule<UserType>>,\n): GroupChannelInviteFragment<UserType> => {\n  const UserListModule = createUserListModule<UserType>(initModule);\n\n  return ({ channel, onPressHeaderLeft, onInviteMembers, sortComparator, queryCreator, renderUser }) => {\n    const { sdk } = useSendbirdChat();\n    const { STRINGS } = useLocalization();\n    const { users, refreshing, refresh, next, error, loading } = useUserList(sdk, {\n      queryCreator,\n      sortComparator,\n    });\n\n    const memberIds = shouldFilterMember(channel) ? channel.members.map((it) => it.userId) : [];\n\n    const _renderUser: NonNullable<typeof renderUser> = useCallback(\n      (user, selectedUsers, setSelectedUsers) => {\n        if (queryCreator && !renderUser) {\n          const hasRequiredKey = 'profileUrl' in user && 'nickname' in user;\n          if (!hasRequiredKey) throw new Error('You should provide \"renderUser\" when providing \"queryCreator\"');\n        }\n\n        if (renderUser) return renderUser(user, selectedUsers, setSelectedUsers);\n\n        const userIdxInMembers = memberIds.indexOf(user.userId);\n        const userIdxInSelectedUsers = selectedUsers.findIndex((it) => it.userId === user.userId);\n\n        const isMember = userIdxInMembers > -1;\n        const isSelected = userIdxInSelectedUsers > -1;\n\n        return (\n          <TouchableOpacity\n            activeOpacity={0.7}\n            disabled={isMember}\n            onPress={() => {\n              setSelectedUsers(([...draft]) => {\n                if (isSelected) draft.splice(userIdxInSelectedUsers, 1);\n                else draft.push(user);\n                return draft;\n              });\n            }}\n          >\n            <UserSelectableBar\n              uri={(user as unknown as SendbirdUser).profileUrl}\n              name={(user as unknown as SendbirdUser).nickname || STRINGS.LABELS.USER_NO_NAME}\n              selected={isMember || isSelected}\n              disabled={isMember}\n            />\n          </TouchableOpacity>\n        );\n      },\n      [channel, renderUser, queryCreator],\n    );\n\n    return (\n      <UserListModule.Provider\n        headerRight={(selectedUsers) => STRINGS.GROUP_CHANNEL_INVITE.HEADER_RIGHT({ selectedUsers })}\n        headerTitle={STRINGS.GROUP_CHANNEL_INVITE.HEADER_TITLE}\n      >\n        <UserListModule.Header\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={async (users) => {\n            const userIds = users.map((it) => it.userId);\n            const updatedChannel = await channel.inviteWithUserIds(userIds);\n            onInviteMembers(updatedChannel);\n          }}\n        />\n        <StatusComposition\n          loading={loading}\n          error={Boolean(error)}\n          LoadingComponent={<UserListModule.StatusLoading />}\n          ErrorComponent={<UserListModule.StatusError onPressRetry={() => refresh()} />}\n        >\n          <UserListModule.List\n            onLoadNext={next}\n            users={users}\n            renderUser={_renderUser}\n            onRefresh={refresh}\n            refreshing={refreshing}\n            ListEmptyComponent={<UserListModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </UserListModule.Provider>\n    );\n  };\n};\n\nfunction shouldFilterMember(channel: SendbirdGroupChannel) {\n  return !channel.isSuper && !channel.isBroadcast;\n}\n\nexport default createGroupChannelInviteFragment;\n"],"mappings":"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"}