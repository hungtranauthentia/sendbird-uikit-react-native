{"version":3,"names":["React","useState","Pressable","useChannelHandler","useMessageOutgoingStatus","GroupChannelPreview","Icon","LoadingSpinner","createStyleSheet","useUIKitTheme","convertFileTypeToMessageType","getFileIconFromMessageType","getFileTypeFromMessage","isDifferentChannel","isMyMessage","isVoiceMessage","useIIFE","useUniqHandlerId","ChannelCover","DEFAULT_LONG_PRESS_DELAY","useLocalization","useSendbirdChat","GroupChannelPreviewContainer","_ref","onPress","onLongPress","channel","currentUser","sdk","sbOptions","mentionManager","STRINGS","colors","typingUsers","setTypingUsers","handlerId","onTypingStatusUpdated","eventChannel","uikit","groupChannel","channelList","enableTypingIndicator","getTypingUsers","outgoingStatus","lastMessage","bodyText","length","LABELS","TYPING_INDICATOR_TYPINGS","GROUP_CHANNEL_LIST","CHANNEL_PREVIEW_BODY","fileType","_channel$lastMessage","isFileMessage","undefined","titleCaptionIcon","isEphemeral","enableMessageReceiptStatus","userId","createElement","size","style","styles","icon","color","error","onBackground03","containerStyle","secondary","unreadMessageCount","delayLongPress","customCover","coverUrl","title","CHANNEL_PREVIEW_TITLE","titleCaptionLeft","titleCaption","CHANNEL_PREVIEW_TITLE_CAPTION","body","bodyIcon","badgeCount","mentioned","unreadMentionCount","mentionTrigger","config","trigger","memberCount","frozen","isFrozen","broadcast","isBroadcast","notificationOff","myPushTriggerOption","marginRight","broadcastCover","padding","borderRadius"],"sources":["GroupChannelPreviewContainer.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Pressable } from 'react-native';\n\nimport { useChannelHandler, useMessageOutgoingStatus } from '@sendbird/uikit-chat-hooks';\nimport {\n  GroupChannelPreview,\n  Icon,\n  LoadingSpinner,\n  createStyleSheet,\n  useUIKitTheme,\n} from '@sendbird/uikit-react-native-foundation';\nimport {\n  SendbirdGroupChannel,\n  SendbirdUser,\n  convertFileTypeToMessageType,\n  getFileIconFromMessageType,\n  getFileTypeFromMessage,\n  isDifferentChannel,\n  isMyMessage,\n  isVoiceMessage,\n  useIIFE,\n  useUniqHandlerId,\n} from '@sendbird/uikit-utils';\n\nimport ChannelCover from '../components/ChannelCover';\nimport { DEFAULT_LONG_PRESS_DELAY } from '../constants';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\ntype Props = {\n  channel: SendbirdGroupChannel;\n  onPress: () => void;\n  onLongPress: () => void;\n};\nconst GroupChannelPreviewContainer = ({ onPress, onLongPress, channel }: Props) => {\n  const { currentUser, sdk, sbOptions, mentionManager } = useSendbirdChat();\n  const { STRINGS } = useLocalization();\n  const { colors } = useUIKitTheme();\n\n  const [typingUsers, setTypingUsers] = useState<SendbirdUser[]>([]);\n\n  const handlerId = useUniqHandlerId('GroupChannelPreviewContainer_TypingIndicator');\n  useChannelHandler(sdk, handlerId, {\n    onTypingStatusUpdated(eventChannel) {\n      if (isDifferentChannel(channel, eventChannel)) return;\n      if (!sbOptions.uikit.groupChannel.channelList.enableTypingIndicator) return;\n      setTypingUsers(eventChannel.getTypingUsers());\n    },\n  });\n\n  const outgoingStatus = useMessageOutgoingStatus(sdk, channel, channel.lastMessage);\n\n  const bodyText = useIIFE(() => {\n    if (typingUsers.length > 0) return STRINGS.LABELS.TYPING_INDICATOR_TYPINGS(typingUsers) || '';\n    else return STRINGS.GROUP_CHANNEL_LIST.CHANNEL_PREVIEW_BODY(channel);\n  });\n\n  const fileType = useIIFE(() => {\n    if (!channel.lastMessage?.isFileMessage()) return undefined;\n    if (typingUsers.length > 0) return undefined;\n    if (isVoiceMessage(channel.lastMessage)) return undefined;\n    return getFileTypeFromMessage(channel.lastMessage);\n  });\n\n  const titleCaptionIcon = useIIFE(() => {\n    if (!channel.lastMessage || channel.isEphemeral) return undefined;\n    if (!sbOptions.uikit.groupChannel.channelList.enableMessageReceiptStatus) return undefined;\n    if (!isMyMessage(channel.lastMessage, currentUser?.userId)) return undefined;\n\n    if (outgoingStatus === 'PENDING') {\n      return <LoadingSpinner size={16} style={styles.titleCaptionIcon} />;\n    }\n\n    if (outgoingStatus === 'FAILED') {\n      return <Icon icon={'error'} size={16} color={colors.error} style={styles.titleCaptionIcon} />;\n    }\n\n    if (outgoingStatus === 'UNDELIVERED') {\n      return <Icon icon={'done'} size={16} color={colors.onBackground03} containerStyle={styles.titleCaptionIcon} />;\n    }\n\n    if (outgoingStatus === 'DELIVERED' || outgoingStatus === 'UNREAD') {\n      return <Icon icon={'done-all'} size={16} color={colors.onBackground03} style={styles.titleCaptionIcon} />;\n    }\n\n    if (outgoingStatus === 'READ') {\n      return <Icon icon={'done-all'} size={16} color={colors.secondary} style={styles.titleCaptionIcon} />;\n    }\n\n    return undefined;\n  });\n\n  const unreadMessageCount = useIIFE(() => (channel.isEphemeral ? 0 : channel.unreadMessageCount));\n\n  return (\n    <Pressable delayLongPress={DEFAULT_LONG_PRESS_DELAY} onPress={onPress} onLongPress={onLongPress}>\n      <GroupChannelPreview\n        customCover={<ChannelCover channel={channel} size={56} />}\n        coverUrl={channel.coverUrl}\n        title={STRINGS.GROUP_CHANNEL_LIST.CHANNEL_PREVIEW_TITLE(currentUser?.userId ?? '', channel)}\n        titleCaptionLeft={titleCaptionIcon}\n        titleCaption={STRINGS.GROUP_CHANNEL_LIST.CHANNEL_PREVIEW_TITLE_CAPTION(channel)}\n        body={bodyText}\n        bodyIcon={fileType && getFileIconFromMessageType(convertFileTypeToMessageType(fileType))}\n        badgeCount={unreadMessageCount}\n        mentioned={channel.unreadMentionCount > 0}\n        mentionTrigger={mentionManager.config.trigger}\n        memberCount={channel.memberCount > 2 ? channel.memberCount : undefined}\n        frozen={channel.isFrozen}\n        broadcast={channel.isBroadcast}\n        notificationOff={channel.myPushTriggerOption === 'off'}\n      />\n    </Pressable>\n  );\n};\n\nconst styles = createStyleSheet({\n  titleCaptionIcon: {\n    marginRight: 4,\n  },\n  broadcastCover: {\n    padding: 12,\n    borderRadius: 28,\n  },\n});\n\nexport default GroupChannelPreviewContainer;\n"],"mappings":"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"}