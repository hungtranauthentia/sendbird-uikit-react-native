{"version":3,"names":["React","createContext","useCallback","useChannelHandler","useActionMenu","useAlert","useBottomSheet","usePrompt","useToast","NOOP","isDifferentChannel","useForceUpdate","useUniqHandlerId","ProviderLayout","useLocalization","usePlatformService","useSendbirdChat","SBUError","SBUUtils","GroupChannelSettingsContexts","Fragment","channel","headerTitle","headerRight","onPressHeaderRight","GroupChannelSettingsContextsProvider","_ref","children","handlerId","forceUpdate","STRINGS","sdk","fileService","alert","onChannelChanged","eventChannel","onChannelFrozen","onChannelUnfrozen","onUserBanned","toast","openSheet","openPrompt","openMenu","updateChannel","params","changeChannelName","title","GROUP_CHANNEL_SETTINGS","DIALOG_CHANGE_NAME_PROMPT_TITLE","submitLabel","DIALOG_CHANGE_NAME_PROMPT_OK","placeholder","DIALOG_CHANGE_NAME_PROMPT_PLACEHOLDER","defaultValue","name","onSubmit","channelName","changeChannelImage","DIALOG_CHANGE_IMAGE_MENU_TITLE","menuItems","DIALOG_CHANGE_IMAGE_MENU_CAMERA","onPress","file","openCamera","mediaType","onOpenFailure","error","code","CODE","ERR_PERMISSIONS_DENIED","DIALOG","ALERT_PERMISSIONS_TITLE","message","ALERT_PERMISSIONS_MESSAGE","LABELS","PERMISSION_CAMERA","PERMISSION_APP_NAME","buttons","text","ALERT_PERMISSIONS_OK","openSettings","show","TOAST","OPEN_CAMERA_ERROR","coverImage","DIALOG_CHANGE_IMAGE_MENU_PHOTO_LIBRARY","files","openMediaLibrary","selectionLimit","PERMISSION_DEVICE_STORAGE","OPEN_PHOTO_LIBRARY_ERROR","sheetItems","DIALOG_CHANGE_NAME","DIALOG_CHANGE_IMAGE","createElement","Provider","value","HEADER_TITLE","HEADER_RIGHT"],"sources":["moduleContext.tsx"],"sourcesContent":["import React, { createContext, useCallback } from 'react';\n\nimport { useChannelHandler } from '@sendbird/uikit-chat-hooks';\nimport { useActionMenu, useAlert, useBottomSheet, usePrompt, useToast } from '@sendbird/uikit-react-native-foundation';\nimport {\n  NOOP,\n  SendbirdBaseChannel,\n  SendbirdGroupChannel,\n  SendbirdGroupChannelUpdateParams,\n  isDifferentChannel,\n  useForceUpdate,\n  useUniqHandlerId,\n} from '@sendbird/uikit-utils';\n\nimport ProviderLayout from '../../../components/ProviderLayout';\nimport { useLocalization, usePlatformService, useSendbirdChat } from '../../../hooks/useContext';\nimport SBUError from '../../../libs/SBUError';\nimport SBUUtils from '../../../libs/SBUUtils';\nimport type { GroupChannelSettingsContextsType, GroupChannelSettingsModule } from '../types';\n\nexport const GroupChannelSettingsContexts: GroupChannelSettingsContextsType = {\n  Fragment: createContext({\n    channel: {} as SendbirdGroupChannel,\n    headerTitle: '',\n    headerRight: '',\n    onPressHeaderRight: NOOP,\n  }),\n};\n\nexport const GroupChannelSettingsContextsProvider: GroupChannelSettingsModule['Provider'] = ({ children, channel }) => {\n  const handlerId = useUniqHandlerId('GroupChannelSettingsContextsProvider');\n  const forceUpdate = useForceUpdate();\n  const { STRINGS } = useLocalization();\n  const { sdk } = useSendbirdChat();\n  const { fileService } = usePlatformService();\n  const { alert } = useAlert();\n\n  const onChannelChanged = (eventChannel: SendbirdBaseChannel) => {\n    if (isDifferentChannel(eventChannel, channel)) return;\n    forceUpdate();\n  };\n\n  useChannelHandler(sdk, handlerId, {\n    onChannelChanged: onChannelChanged,\n    onChannelFrozen: onChannelChanged,\n    onChannelUnfrozen: onChannelChanged,\n    onUserBanned: onChannelChanged,\n  });\n\n  const toast = useToast();\n  const { openSheet } = useBottomSheet();\n  const { openPrompt } = usePrompt();\n  const { openMenu } = useActionMenu();\n\n  const updateChannel = useCallback(\n    async (params: SendbirdGroupChannelUpdateParams) => {\n      await channel.updateChannel(params);\n      forceUpdate();\n    },\n    [channel],\n  );\n\n  const changeChannelName = useCallback(() => {\n    openPrompt({\n      title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_TITLE,\n      submitLabel: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_OK,\n      placeholder: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_PLACEHOLDER,\n      defaultValue: channel.name,\n      onSubmit: (channelName) => updateChannel({ name: channelName }),\n    });\n  }, [STRINGS, updateChannel, channel.name]);\n\n  const changeChannelImage = useCallback(() => {\n    openMenu({\n      title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_TITLE,\n      menuItems: [\n        {\n          title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_CAMERA,\n          onPress: async () => {\n            const file = await fileService.openCamera({\n              mediaType: 'photo',\n              onOpenFailure: (error) => {\n                if (error.code === SBUError.CODE.ERR_PERMISSIONS_DENIED) {\n                  alert({\n                    title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n                    message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n                      STRINGS.LABELS.PERMISSION_CAMERA,\n                      STRINGS.LABELS.PERMISSION_APP_NAME,\n                    ),\n                    buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n                  });\n                } else {\n                  toast.show(STRINGS.TOAST.OPEN_CAMERA_ERROR, 'error');\n                }\n              },\n            });\n            if (!file) return;\n\n            await updateChannel({ coverImage: file });\n          },\n        },\n        {\n          title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_PHOTO_LIBRARY,\n          onPress: async () => {\n            const files = await fileService.openMediaLibrary({\n              selectionLimit: 1,\n              mediaType: 'photo',\n              onOpenFailure: (error) => {\n                if (error.code === SBUError.CODE.ERR_PERMISSIONS_DENIED) {\n                  alert({\n                    title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n                    message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n                      STRINGS.LABELS.PERMISSION_DEVICE_STORAGE,\n                      STRINGS.LABELS.PERMISSION_APP_NAME,\n                    ),\n                    buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n                  });\n                } else {\n                  toast.show(STRINGS.TOAST.OPEN_PHOTO_LIBRARY_ERROR, 'error');\n                }\n              },\n            });\n            if (!files || !files[0]) return;\n\n            await updateChannel({ coverImage: files[0] });\n          },\n        },\n      ],\n    });\n  }, [STRINGS, updateChannel]);\n\n  const onPressHeaderRight = useCallback(() => {\n    openSheet({\n      sheetItems: [\n        { title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME, onPress: changeChannelName },\n        { title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE, onPress: changeChannelImage },\n      ],\n    });\n  }, [STRINGS, changeChannelImage, changeChannelName]);\n\n  return (\n    <ProviderLayout>\n      <GroupChannelSettingsContexts.Fragment.Provider\n        value={{\n          channel,\n          headerTitle: STRINGS.GROUP_CHANNEL_SETTINGS.HEADER_TITLE,\n          headerRight: STRINGS.GROUP_CHANNEL_SETTINGS.HEADER_RIGHT,\n          onPressHeaderRight,\n        }}\n      >\n        {children}\n      </GroupChannelSettingsContexts.Fragment.Provider>\n    </ProviderLayout>\n  );\n};\n"],"mappings":"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"}