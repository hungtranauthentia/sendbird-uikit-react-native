{"version":3,"names":["React","useContext","View","PushTriggerOption","Icon","MenuBar","Switch","useUIKitTheme","Logger","conditionChaining","useIIFE","useLocalization","useSendbirdChat","GroupChannelSettingsContexts","WARN_onPressMenuNotification","WARN_onPressMenuSearchInChannel","GroupChannelSettingsMenu","_ref","onPressMenuModeration","onPressMenuMembers","onPressMenuSearchInChannel","onPressMenuLeaveChannel","onPressMenuNotification","menuItemsCreator","menu","sdk","sbOptions","channel","Fragment","STRINGS","colors","__DEV__","uikit","groupChannel","enableMention","warn","uikitWithAppInfo","setting","enableMessageSearch","toggleNotification","myPushTriggerOption","setMyPushTriggerOption","DEFAULT","OFF","onPressNotificationMenu","actionLabelNotificationMenu","actionItemNotificationMenu","getNotificationsLabel","ALL","GROUP_CHANNEL_SETTINGS","MENU_NOTIFICATION_LABEL_ON","MENU_NOTIFICATION_LABEL_OFF","MENTION_ONLY","MENU_NOTIFICATION_LABEL_MENTION_ONLY","createElement","icon","color","onBackground01","value","onChangeValue","defaultMenuItems","visible","myRole","name","MENU_MODERATION","onPress","actionItem","MENU_NOTIFICATION","actionLabel","MENU_MEMBERS","String","memberCount","isEphemeral","push","MENU_SEARCH","iconColor","error","MENU_LEAVE_CHANNEL","leave","then","clearCachedMessages","url","catch","menuItems","map","key","disabled","iconBackgroundColor"],"sources":["GroupChannelSettingsMenu.tsx"],"sourcesContent":["import React, { useContext } from 'react';\nimport { View } from 'react-native';\n\nimport { PushTriggerOption } from '@sendbird/chat';\nimport type { MenuBarProps } from '@sendbird/uikit-react-native-foundation';\nimport { Icon, MenuBar, Switch, useUIKitTheme } from '@sendbird/uikit-react-native-foundation';\nimport { Logger, conditionChaining, useIIFE } from '@sendbird/uikit-utils';\n\nimport { useLocalization, useSendbirdChat } from '../../../hooks/useContext';\nimport { GroupChannelSettingsContexts } from '../module/moduleContext';\nimport type { GroupChannelSettingsProps } from '../types';\n\nlet WARN_onPressMenuNotification = false;\nlet WARN_onPressMenuSearchInChannel = false;\n\nconst GroupChannelSettingsMenu = ({\n  onPressMenuModeration,\n  onPressMenuMembers,\n  onPressMenuSearchInChannel,\n  onPressMenuLeaveChannel,\n  onPressMenuNotification,\n  menuItemsCreator = (menu) => menu,\n}: GroupChannelSettingsProps['Menu']) => {\n  const { sdk, sbOptions } = useSendbirdChat();\n  const { channel } = useContext(GroupChannelSettingsContexts.Fragment);\n  const { STRINGS } = useLocalization();\n  const { colors } = useUIKitTheme();\n\n  if (\n    __DEV__ &&\n    !WARN_onPressMenuNotification &&\n    !onPressMenuNotification &&\n    sbOptions.uikit.groupChannel.channel.enableMention\n  ) {\n    Logger.warn('If you are using mention, make sure to pass the `onPressMenuNotification` prop');\n    WARN_onPressMenuNotification = true;\n  }\n\n  if (\n    __DEV__ &&\n    !WARN_onPressMenuSearchInChannel &&\n    !onPressMenuSearchInChannel &&\n    sbOptions.uikitWithAppInfo.groupChannel.setting.enableMessageSearch\n  ) {\n    Logger.warn('If you are using message search, make sure to pass the `onPressMenuSearchInChannel` prop');\n    WARN_onPressMenuSearchInChannel = true;\n  }\n\n  const toggleNotification = async () => {\n    if (channel.myPushTriggerOption === 'off') {\n      await channel.setMyPushTriggerOption(PushTriggerOption.DEFAULT);\n    } else {\n      await channel.setMyPushTriggerOption(PushTriggerOption.OFF);\n    }\n  };\n\n  const { onPressNotificationMenu, actionLabelNotificationMenu, actionItemNotificationMenu } = useIIFE(() => {\n    const getNotificationsLabel = () => {\n      switch (channel.myPushTriggerOption) {\n        case PushTriggerOption.ALL:\n        case PushTriggerOption.DEFAULT:\n          return STRINGS.GROUP_CHANNEL_SETTINGS.MENU_NOTIFICATION_LABEL_ON;\n        case PushTriggerOption.OFF:\n          return STRINGS.GROUP_CHANNEL_SETTINGS.MENU_NOTIFICATION_LABEL_OFF;\n        case PushTriggerOption.MENTION_ONLY:\n          return STRINGS.GROUP_CHANNEL_SETTINGS.MENU_NOTIFICATION_LABEL_MENTION_ONLY;\n      }\n    };\n\n    return {\n      actionLabelNotificationMenu: getNotificationsLabel(),\n      actionItemNotificationMenu: conditionChaining(\n        [sbOptions.uikit.groupChannel.channel.enableMention],\n        [\n          <Icon icon={'chevron-right'} color={colors.onBackground01} />,\n          <Switch value={channel.myPushTriggerOption !== 'off'} onChangeValue={toggleNotification} />,\n        ],\n      ),\n      onPressNotificationMenu: () => {\n        if (sbOptions.uikit.groupChannel.channel.enableMention) onPressMenuNotification?.();\n        else toggleNotification();\n      },\n    };\n  });\n\n  const defaultMenuItems: MenuBarProps[] = [\n    {\n      icon: 'moderation',\n      visible: channel.myRole === 'operator',\n      name: STRINGS.GROUP_CHANNEL_SETTINGS.MENU_MODERATION,\n      onPress: () => onPressMenuModeration(),\n      actionItem: <Icon icon={'chevron-right'} color={colors.onBackground01} />,\n    },\n    {\n      icon: 'notifications',\n      name: STRINGS.GROUP_CHANNEL_SETTINGS.MENU_NOTIFICATION,\n      onPress: onPressNotificationMenu,\n      actionLabel: actionLabelNotificationMenu,\n      actionItem: actionItemNotificationMenu,\n    },\n    {\n      icon: 'members',\n      name: STRINGS.GROUP_CHANNEL_SETTINGS.MENU_MEMBERS,\n      onPress: () => onPressMenuMembers(),\n      actionLabel: String(channel.memberCount),\n      actionItem: <Icon icon={'chevron-right'} color={colors.onBackground01} />,\n    },\n  ];\n\n  if (sbOptions.uikitWithAppInfo.groupChannel.setting.enableMessageSearch && !channel.isEphemeral) {\n    defaultMenuItems.push({\n      icon: 'search',\n      name: STRINGS.GROUP_CHANNEL_SETTINGS.MENU_SEARCH,\n      onPress: () => onPressMenuSearchInChannel?.(),\n    });\n  }\n\n  defaultMenuItems.push({\n    icon: 'leave',\n    iconColor: colors.error,\n    name: STRINGS.GROUP_CHANNEL_SETTINGS.MENU_LEAVE_CHANNEL,\n    onPress: () => {\n      channel.leave().then(() => {\n        onPressMenuLeaveChannel();\n        sdk.clearCachedMessages([channel.url]).catch();\n      });\n    },\n  });\n\n  const menuItems = menuItemsCreator(defaultMenuItems);\n\n  return (\n    <View>\n      {menuItems.map((menu) => {\n        return (\n          <MenuBar\n            key={menu.name}\n            onPress={menu.onPress}\n            name={menu.name}\n            disabled={menu.disabled}\n            visible={menu.visible}\n            icon={menu.icon}\n            iconColor={menu.iconColor}\n            iconBackgroundColor={menu.iconBackgroundColor}\n            actionLabel={menu.actionLabel}\n            actionItem={menu.actionItem}\n          />\n        );\n      })}\n    </View>\n  );\n};\n\nexport default GroupChannelSettingsMenu;\n"],"mappings":"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"}