{"version":3,"names":["React","createContext","useCallback","useChannelHandler","useActionMenu","useAlert","useBottomSheet","usePrompt","useToast","NOOP","isDifferentChannel","useForceUpdate","useUniqHandlerId","ProviderLayout","useLocalization","usePlatformService","useSendbirdChat","SBUError","SBUUtils","OpenChannelSettingsContexts","Fragment","channel","headerTitle","headerRight","onPressHeaderRight","OpenChannelSettingsContextsProvider","_ref","onNavigateToOpenChannel","children","handlerId","forceUpdate","STRINGS","sdk","currentUser","fileService","alert","onChannelChanged","eventChannel","onOperatorUpdated","isOpenChannel","isOperator","userId","onChannelUnfrozen","onChannelFrozen","onUserBanned","toast","openSheet","openPrompt","openMenu","updateChannel","params","changeChannelName","title","OPEN_CHANNEL_SETTINGS","DIALOG_CHANGE_NAME_PROMPT_TITLE","submitLabel","DIALOG_CHANGE_NAME_PROMPT_OK","placeholder","DIALOG_CHANGE_NAME_PROMPT_PLACEHOLDER","defaultValue","name","onSubmit","channelName","changeChannelImage","DIALOG_CHANGE_IMAGE_MENU_TITLE","menuItems","DIALOG_CHANGE_IMAGE_MENU_CAMERA","onPress","file","openCamera","mediaType","onOpenFailure","error","code","CODE","ERR_PERMISSIONS_DENIED","DIALOG","ALERT_PERMISSIONS_TITLE","message","ALERT_PERMISSIONS_MESSAGE","LABELS","PERMISSION_CAMERA","PERMISSION_APP_NAME","buttons","text","ALERT_PERMISSIONS_OK","openSettings","show","TOAST","OPEN_CAMERA_ERROR","coverUrlOrImage","DIALOG_CHANGE_IMAGE_MENU_PHOTO_LIBRARY","files","openMediaLibrary","selectionLimit","PERMISSION_DEVICE_STORAGE","OPEN_PHOTO_LIBRARY_ERROR","sheetItems","DIALOG_CHANGE_NAME","DIALOG_CHANGE_IMAGE","createElement","Provider","value","HEADER_TITLE","HEADER_RIGHT"],"sources":["moduleContext.tsx"],"sourcesContent":["import React, { createContext, useCallback } from 'react';\n\nimport { useChannelHandler } from '@sendbird/uikit-chat-hooks';\nimport { useActionMenu, useAlert, useBottomSheet, usePrompt, useToast } from '@sendbird/uikit-react-native-foundation';\nimport {\n  NOOP,\n  SendbirdBaseChannel,\n  SendbirdOpenChannel,\n  SendbirdOpenChannelUpdateParams,\n  isDifferentChannel,\n  useForceUpdate,\n  useUniqHandlerId,\n} from '@sendbird/uikit-utils';\n\nimport ProviderLayout from '../../../components/ProviderLayout';\nimport { useLocalization, usePlatformService, useSendbirdChat } from '../../../hooks/useContext';\nimport SBUError from '../../../libs/SBUError';\nimport SBUUtils from '../../../libs/SBUUtils';\nimport type { OpenChannelSettingsContextsType, OpenChannelSettingsModule } from '../types';\n\nexport const OpenChannelSettingsContexts: OpenChannelSettingsContextsType = {\n  Fragment: createContext({\n    channel: {} as SendbirdOpenChannel,\n    headerTitle: '',\n    headerRight: '',\n    onPressHeaderRight: NOOP,\n  }),\n};\n\nexport const OpenChannelSettingsContextsProvider: OpenChannelSettingsModule['Provider'] = ({\n  channel,\n  onNavigateToOpenChannel,\n  children,\n}) => {\n  const handlerId = useUniqHandlerId('OpenChannelSettingsContextsProvider');\n  const forceUpdate = useForceUpdate();\n  const { STRINGS } = useLocalization();\n  const { sdk, currentUser } = useSendbirdChat();\n  const { fileService } = usePlatformService();\n  const { alert } = useAlert();\n\n  const onChannelChanged = (eventChannel: SendbirdBaseChannel) => {\n    if (isDifferentChannel(eventChannel, channel)) return;\n    forceUpdate();\n  };\n  const onOperatorUpdated = (eventChannel: SendbirdBaseChannel) => {\n    if (isDifferentChannel(eventChannel, channel) || !eventChannel.isOpenChannel()) return;\n    if (currentUser && !eventChannel.isOperator(currentUser.userId)) {\n      onNavigateToOpenChannel();\n    }\n  };\n\n  useChannelHandler(\n    sdk,\n    handlerId,\n    {\n      onOperatorUpdated: onOperatorUpdated,\n      onChannelUnfrozen: onChannelChanged,\n      onChannelChanged: onChannelChanged,\n      onChannelFrozen: onChannelChanged,\n      onUserBanned: onChannelChanged,\n    },\n    'open',\n  );\n\n  const toast = useToast();\n  const { openSheet } = useBottomSheet();\n  const { openPrompt } = usePrompt();\n  const { openMenu } = useActionMenu();\n\n  const updateChannel = useCallback(\n    async (params: SendbirdOpenChannelUpdateParams) => {\n      await channel.updateChannel(params);\n      forceUpdate();\n    },\n    [channel],\n  );\n\n  const changeChannelName = useCallback(() => {\n    openPrompt({\n      title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_TITLE,\n      submitLabel: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_OK,\n      placeholder: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_PLACEHOLDER,\n      defaultValue: channel.name,\n      onSubmit: (channelName) => updateChannel({ name: channelName }),\n    });\n  }, [STRINGS, updateChannel, channel.name]);\n\n  const changeChannelImage = useCallback(() => {\n    openMenu({\n      title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_TITLE,\n      menuItems: [\n        {\n          title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_CAMERA,\n          onPress: async () => {\n            const file = await fileService.openCamera({\n              mediaType: 'photo',\n              onOpenFailure: (error) => {\n                if (error.code === SBUError.CODE.ERR_PERMISSIONS_DENIED) {\n                  alert({\n                    title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n                    message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n                      STRINGS.LABELS.PERMISSION_CAMERA,\n                      STRINGS.LABELS.PERMISSION_APP_NAME,\n                    ),\n                    buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n                  });\n                } else {\n                  toast.show(STRINGS.TOAST.OPEN_CAMERA_ERROR, 'error');\n                }\n              },\n            });\n            if (!file) return;\n\n            await updateChannel({ coverUrlOrImage: file });\n          },\n        },\n        {\n          title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_PHOTO_LIBRARY,\n          onPress: async () => {\n            const files = await fileService.openMediaLibrary({\n              selectionLimit: 1,\n              mediaType: 'photo',\n              onOpenFailure: (error) => {\n                if (error.code === SBUError.CODE.ERR_PERMISSIONS_DENIED) {\n                  alert({\n                    title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n                    message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n                      STRINGS.LABELS.PERMISSION_DEVICE_STORAGE,\n                      STRINGS.LABELS.PERMISSION_APP_NAME,\n                    ),\n                    buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n                  });\n                } else {\n                  toast.show(STRINGS.TOAST.OPEN_PHOTO_LIBRARY_ERROR, 'error');\n                }\n              },\n            });\n            if (!files || !files[0]) return;\n\n            await updateChannel({ coverUrlOrImage: files[0] });\n          },\n        },\n      ],\n    });\n  }, [STRINGS, updateChannel]);\n\n  const onPressHeaderRight = useCallback(() => {\n    openSheet({\n      sheetItems: [\n        { title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME, onPress: changeChannelName },\n        { title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE, onPress: changeChannelImage },\n      ],\n    });\n  }, [STRINGS, changeChannelImage, changeChannelName]);\n\n  return (\n    <ProviderLayout>\n      <OpenChannelSettingsContexts.Fragment.Provider\n        value={{\n          channel,\n          headerTitle: STRINGS.OPEN_CHANNEL_SETTINGS.HEADER_TITLE,\n          headerRight: STRINGS.OPEN_CHANNEL_SETTINGS.HEADER_RIGHT,\n          onPressHeaderRight,\n        }}\n      >\n        {children}\n      </OpenChannelSettingsContexts.Fragment.Provider>\n    </ProviderLayout>\n  );\n};\n"],"mappings":"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"}