{"version":3,"names":["_react","_interopRequireWildcard","require","_uikitChatHooks","_uikitReactNativeFoundation","_uikitUtils","_ProviderLayout","_interopRequireDefault","_useContext","_SBUError","_SBUUtils","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","OpenChannelSettingsContexts","Fragment","createContext","channel","headerTitle","headerRight","onPressHeaderRight","NOOP","exports","OpenChannelSettingsContextsProvider","_ref","onNavigateToOpenChannel","children","handlerId","useUniqHandlerId","forceUpdate","useForceUpdate","STRINGS","useLocalization","sdk","currentUser","useSendbirdChat","fileService","usePlatformService","alert","useAlert","onChannelChanged","eventChannel","isDifferentChannel","onOperatorUpdated","isOpenChannel","isOperator","userId","useChannelHandler","onChannelUnfrozen","onChannelFrozen","onUserBanned","toast","useToast","openSheet","useBottomSheet","openPrompt","usePrompt","openMenu","useActionMenu","updateChannel","useCallback","params","changeChannelName","title","OPEN_CHANNEL_SETTINGS","DIALOG_CHANGE_NAME_PROMPT_TITLE","submitLabel","DIALOG_CHANGE_NAME_PROMPT_OK","placeholder","DIALOG_CHANGE_NAME_PROMPT_PLACEHOLDER","defaultValue","name","onSubmit","channelName","changeChannelImage","DIALOG_CHANGE_IMAGE_MENU_TITLE","menuItems","DIALOG_CHANGE_IMAGE_MENU_CAMERA","onPress","file","openCamera","mediaType","onOpenFailure","error","code","SBUError","CODE","ERR_PERMISSIONS_DENIED","DIALOG","ALERT_PERMISSIONS_TITLE","message","ALERT_PERMISSIONS_MESSAGE","LABELS","PERMISSION_CAMERA","PERMISSION_APP_NAME","buttons","text","ALERT_PERMISSIONS_OK","SBUUtils","openSettings","show","TOAST","OPEN_CAMERA_ERROR","coverUrlOrImage","DIALOG_CHANGE_IMAGE_MENU_PHOTO_LIBRARY","files","openMediaLibrary","selectionLimit","PERMISSION_DEVICE_STORAGE","OPEN_PHOTO_LIBRARY_ERROR","sheetItems","DIALOG_CHANGE_NAME","DIALOG_CHANGE_IMAGE","createElement","Provider","value","HEADER_TITLE","HEADER_RIGHT"],"sources":["moduleContext.tsx"],"sourcesContent":["import React, { createContext, useCallback } from 'react';\n\nimport { useChannelHandler } from '@sendbird/uikit-chat-hooks';\nimport { useActionMenu, useAlert, useBottomSheet, usePrompt, useToast } from '@sendbird/uikit-react-native-foundation';\nimport {\n  NOOP,\n  SendbirdBaseChannel,\n  SendbirdOpenChannel,\n  SendbirdOpenChannelUpdateParams,\n  isDifferentChannel,\n  useForceUpdate,\n  useUniqHandlerId,\n} from '@sendbird/uikit-utils';\n\nimport ProviderLayout from '../../../components/ProviderLayout';\nimport { useLocalization, usePlatformService, useSendbirdChat } from '../../../hooks/useContext';\nimport SBUError from '../../../libs/SBUError';\nimport SBUUtils from '../../../libs/SBUUtils';\nimport type { OpenChannelSettingsContextsType, OpenChannelSettingsModule } from '../types';\n\nexport const OpenChannelSettingsContexts: OpenChannelSettingsContextsType = {\n  Fragment: createContext({\n    channel: {} as SendbirdOpenChannel,\n    headerTitle: '',\n    headerRight: '',\n    onPressHeaderRight: NOOP,\n  }),\n};\n\nexport const OpenChannelSettingsContextsProvider: OpenChannelSettingsModule['Provider'] = ({\n  channel,\n  onNavigateToOpenChannel,\n  children,\n}) => {\n  const handlerId = useUniqHandlerId('OpenChannelSettingsContextsProvider');\n  const forceUpdate = useForceUpdate();\n  const { STRINGS } = useLocalization();\n  const { sdk, currentUser } = useSendbirdChat();\n  const { fileService } = usePlatformService();\n  const { alert } = useAlert();\n\n  const onChannelChanged = (eventChannel: SendbirdBaseChannel) => {\n    if (isDifferentChannel(eventChannel, channel)) return;\n    forceUpdate();\n  };\n  const onOperatorUpdated = (eventChannel: SendbirdBaseChannel) => {\n    if (isDifferentChannel(eventChannel, channel) || !eventChannel.isOpenChannel()) return;\n    if (currentUser && !eventChannel.isOperator(currentUser.userId)) {\n      onNavigateToOpenChannel();\n    }\n  };\n\n  useChannelHandler(\n    sdk,\n    handlerId,\n    {\n      onOperatorUpdated: onOperatorUpdated,\n      onChannelUnfrozen: onChannelChanged,\n      onChannelChanged: onChannelChanged,\n      onChannelFrozen: onChannelChanged,\n      onUserBanned: onChannelChanged,\n    },\n    'open',\n  );\n\n  const toast = useToast();\n  const { openSheet } = useBottomSheet();\n  const { openPrompt } = usePrompt();\n  const { openMenu } = useActionMenu();\n\n  const updateChannel = useCallback(\n    async (params: SendbirdOpenChannelUpdateParams) => {\n      await channel.updateChannel(params);\n      forceUpdate();\n    },\n    [channel],\n  );\n\n  const changeChannelName = useCallback(() => {\n    openPrompt({\n      title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_TITLE,\n      submitLabel: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_OK,\n      placeholder: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_PLACEHOLDER,\n      defaultValue: channel.name,\n      onSubmit: (channelName) => updateChannel({ name: channelName }),\n    });\n  }, [STRINGS, updateChannel, channel.name]);\n\n  const changeChannelImage = useCallback(() => {\n    openMenu({\n      title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_TITLE,\n      menuItems: [\n        {\n          title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_CAMERA,\n          onPress: async () => {\n            const file = await fileService.openCamera({\n              mediaType: 'photo',\n              onOpenFailure: (error) => {\n                if (error.code === SBUError.CODE.ERR_PERMISSIONS_DENIED) {\n                  alert({\n                    title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n                    message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n                      STRINGS.LABELS.PERMISSION_CAMERA,\n                      STRINGS.LABELS.PERMISSION_APP_NAME,\n                    ),\n                    buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n                  });\n                } else {\n                  toast.show(STRINGS.TOAST.OPEN_CAMERA_ERROR, 'error');\n                }\n              },\n            });\n            if (!file) return;\n\n            await updateChannel({ coverUrlOrImage: file });\n          },\n        },\n        {\n          title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_PHOTO_LIBRARY,\n          onPress: async () => {\n            const files = await fileService.openMediaLibrary({\n              selectionLimit: 1,\n              mediaType: 'photo',\n              onOpenFailure: (error) => {\n                if (error.code === SBUError.CODE.ERR_PERMISSIONS_DENIED) {\n                  alert({\n                    title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n                    message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n                      STRINGS.LABELS.PERMISSION_DEVICE_STORAGE,\n                      STRINGS.LABELS.PERMISSION_APP_NAME,\n                    ),\n                    buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n                  });\n                } else {\n                  toast.show(STRINGS.TOAST.OPEN_PHOTO_LIBRARY_ERROR, 'error');\n                }\n              },\n            });\n            if (!files || !files[0]) return;\n\n            await updateChannel({ coverUrlOrImage: files[0] });\n          },\n        },\n      ],\n    });\n  }, [STRINGS, updateChannel]);\n\n  const onPressHeaderRight = useCallback(() => {\n    openSheet({\n      sheetItems: [\n        { title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME, onPress: changeChannelName },\n        { title: STRINGS.OPEN_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE, onPress: changeChannelImage },\n      ],\n    });\n  }, [STRINGS, changeChannelImage, changeChannelName]);\n\n  return (\n    <ProviderLayout>\n      <OpenChannelSettingsContexts.Fragment.Provider\n        value={{\n          channel,\n          headerTitle: STRINGS.OPEN_CHANNEL_SETTINGS.HEADER_TITLE,\n          headerRight: STRINGS.OPEN_CHANNEL_SETTINGS.HEADER_RIGHT,\n          onPressHeaderRight,\n        }}\n      >\n        {children}\n      </OpenChannelSettingsContexts.Fragment.Provider>\n    </ProviderLayout>\n  );\n};\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,uBAAA,CAAAC,OAAA;AAEA,IAAAC,eAAA,GAAAD,OAAA;AACA,IAAAE,2BAAA,GAAAF,OAAA;AACA,IAAAG,WAAA,GAAAH,OAAA;AAUA,IAAAI,eAAA,GAAAC,sBAAA,CAAAL,OAAA;AACA,IAAAM,WAAA,GAAAN,OAAA;AACA,IAAAO,SAAA,GAAAF,sBAAA,CAAAL,OAAA;AACA,IAAAQ,SAAA,GAAAH,sBAAA,CAAAL,OAAA;AAA8C,SAAAK,uBAAAI,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAAA,SAAAG,yBAAAC,WAAA,eAAAC,OAAA,kCAAAC,iBAAA,OAAAD,OAAA,QAAAE,gBAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,WAAA,WAAAA,WAAA,GAAAG,gBAAA,GAAAD,iBAAA,KAAAF,WAAA;AAAA,SAAAd,wBAAAU,GAAA,EAAAI,WAAA,SAAAA,WAAA,IAAAJ,GAAA,IAAAA,GAAA,CAAAC,UAAA,WAAAD,GAAA,QAAAA,GAAA,oBAAAA,GAAA,wBAAAA,GAAA,4BAAAE,OAAA,EAAAF,GAAA,UAAAQ,KAAA,GAAAL,wBAAA,CAAAC,WAAA,OAAAI,KAAA,IAAAA,KAAA,CAAAC,GAAA,CAAAT,GAAA,YAAAQ,KAAA,CAAAE,GAAA,CAAAV,GAAA,SAAAW,MAAA,WAAAC,qBAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,GAAA,IAAAhB,GAAA,QAAAgB,GAAA,kBAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAnB,GAAA,EAAAgB,GAAA,SAAAI,IAAA,GAAAR,qBAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAf,GAAA,EAAAgB,GAAA,cAAAI,IAAA,KAAAA,IAAA,CAAAV,GAAA,IAAAU,IAAA,CAAAC,GAAA,KAAAR,MAAA,CAAAC,cAAA,CAAAH,MAAA,EAAAK,GAAA,EAAAI,IAAA,YAAAT,MAAA,CAAAK,GAAA,IAAAhB,GAAA,CAAAgB,GAAA,SAAAL,MAAA,CAAAT,OAAA,GAAAF,GAAA,MAAAQ,KAAA,IAAAA,KAAA,CAAAa,GAAA,CAAArB,GAAA,EAAAW,MAAA,YAAAA,MAAA;AAGvC,MAAMW,2BAA4D,GAAG;EAC1EC,QAAQ,eAAE,IAAAC,oBAAa,EAAC;IACtBC,OAAO,EAAE,CAAC,CAAwB;IAClCC,WAAW,EAAE,EAAE;IACfC,WAAW,EAAE,EAAE;IACfC,kBAAkB,EAAEC;EACtB,CAAC;AACH,CAAC;AAACC,OAAA,CAAAR,2BAAA,GAAAA,2BAAA;AAEK,MAAMS,mCAA0E,GAAGC,IAAA,IAIpF;EAAA,IAJqF;IACzFP,OAAO;IACPQ,uBAAuB;IACvBC;EACF,CAAC,GAAAF,IAAA;EACC,MAAMG,SAAS,GAAG,IAAAC,4BAAgB,EAAC,qCAAqC,CAAC;EACzE,MAAMC,WAAW,GAAG,IAAAC,0BAAc,GAAE;EACpC,MAAM;IAAEC;EAAQ,CAAC,GAAG,IAAAC,2BAAe,GAAE;EACrC,MAAM;IAAEC,GAAG;IAAEC;EAAY,CAAC,GAAG,IAAAC,2BAAe,GAAE;EAC9C,MAAM;IAAEC;EAAY,CAAC,GAAG,IAAAC,8BAAkB,GAAE;EAC5C,MAAM;IAAEC;EAAM,CAAC,GAAG,IAAAC,oCAAQ,GAAE;EAE5B,MAAMC,gBAAgB,GAAIC,YAAiC,IAAK;IAC9D,IAAI,IAAAC,8BAAkB,EAACD,YAAY,EAAExB,OAAO,CAAC,EAAE;IAC/CY,WAAW,EAAE;EACf,CAAC;EACD,MAAMc,iBAAiB,GAAIF,YAAiC,IAAK;IAC/D,IAAI,IAAAC,8BAAkB,EAACD,YAAY,EAAExB,OAAO,CAAC,IAAI,CAACwB,YAAY,CAACG,aAAa,EAAE,EAAE;IAChF,IAAIV,WAAW,IAAI,CAACO,YAAY,CAACI,UAAU,CAACX,WAAW,CAACY,MAAM,CAAC,EAAE;MAC/DrB,uBAAuB,EAAE;IAC3B;EACF,CAAC;EAED,IAAAsB,iCAAiB,EACfd,GAAG,EACHN,SAAS,EACT;IACEgB,iBAAiB,EAAEA,iBAAiB;IACpCK,iBAAiB,EAAER,gBAAgB;IACnCA,gBAAgB,EAAEA,gBAAgB;IAClCS,eAAe,EAAET,gBAAgB;IACjCU,YAAY,EAAEV;EAChB,CAAC,EACD,MAAM,CACP;EAED,MAAMW,KAAK,GAAG,IAAAC,oCAAQ,GAAE;EACxB,MAAM;IAAEC;EAAU,CAAC,GAAG,IAAAC,0CAAc,GAAE;EACtC,MAAM;IAAEC;EAAW,CAAC,GAAG,IAAAC,qCAAS,GAAE;EAClC,MAAM;IAAEC;EAAS,CAAC,GAAG,IAAAC,yCAAa,GAAE;EAEpC,MAAMC,aAAa,GAAG,IAAAC,kBAAW,EAC/B,MAAOC,MAAuC,IAAK;IACjD,MAAM5C,OAAO,CAAC0C,aAAa,CAACE,MAAM,CAAC;IACnChC,WAAW,EAAE;EACf,CAAC,EACD,CAACZ,OAAO,CAAC,CACV;EAED,MAAM6C,iBAAiB,GAAG,IAAAF,kBAAW,EAAC,MAAM;IAC1CL,UAAU,CAAC;MACTQ,KAAK,EAAEhC,OAAO,CAACiC,qBAAqB,CAACC,+BAA+B;MACpEC,WAAW,EAAEnC,OAAO,CAACiC,qBAAqB,CAACG,4BAA4B;MACvEC,WAAW,EAAErC,OAAO,CAACiC,qBAAqB,CAACK,qCAAqC;MAChFC,YAAY,EAAErD,OAAO,CAACsD,IAAI;MAC1BC,QAAQ,EAAGC,WAAW,IAAKd,aAAa,CAAC;QAAEY,IAAI,EAAEE;MAAY,CAAC;IAChE,CAAC,CAAC;EACJ,CAAC,EAAE,CAAC1C,OAAO,EAAE4B,aAAa,EAAE1C,OAAO,CAACsD,IAAI,CAAC,CAAC;EAE1C,MAAMG,kBAAkB,GAAG,IAAAd,kBAAW,EAAC,MAAM;IAC3CH,QAAQ,CAAC;MACPM,KAAK,EAAEhC,OAAO,CAACiC,qBAAqB,CAACW,8BAA8B;MACnEC,SAAS,EAAE,CACT;QACEb,KAAK,EAAEhC,OAAO,CAACiC,qBAAqB,CAACa,+BAA+B;QACpEC,OAAO,EAAE,MAAAA,CAAA,KAAY;UACnB,MAAMC,IAAI,GAAG,MAAM3C,WAAW,CAAC4C,UAAU,CAAC;YACxCC,SAAS,EAAE,OAAO;YAClBC,aAAa,EAAGC,KAAK,IAAK;cACxB,IAAIA,KAAK,CAACC,IAAI,KAAKC,iBAAQ,CAACC,IAAI,CAACC,sBAAsB,EAAE;gBACvDjD,KAAK,CAAC;kBACJyB,KAAK,EAAEhC,OAAO,CAACyD,MAAM,CAACC,uBAAuB;kBAC7CC,OAAO,EAAE3D,OAAO,CAACyD,MAAM,CAACG,yBAAyB,CAC/C5D,OAAO,CAAC6D,MAAM,CAACC,iBAAiB,EAChC9D,OAAO,CAAC6D,MAAM,CAACE,mBAAmB,CACnC;kBACDC,OAAO,EAAE,CAAC;oBAAEC,IAAI,EAAEjE,OAAO,CAACyD,MAAM,CAACS,oBAAoB;oBAAEnB,OAAO,EAAEA,CAAA,KAAMoB,iBAAQ,CAACC,YAAY;kBAAG,CAAC;gBACjG,CAAC,CAAC;cACJ,CAAC,MAAM;gBACLhD,KAAK,CAACiD,IAAI,CAACrE,OAAO,CAACsE,KAAK,CAACC,iBAAiB,EAAE,OAAO,CAAC;cACtD;YACF;UACF,CAAC,CAAC;UACF,IAAI,CAACvB,IAAI,EAAE;UAEX,MAAMpB,aAAa,CAAC;YAAE4C,eAAe,EAAExB;UAAK,CAAC,CAAC;QAChD;MACF,CAAC,EACD;QACEhB,KAAK,EAAEhC,OAAO,CAACiC,qBAAqB,CAACwC,sCAAsC;QAC3E1B,OAAO,EAAE,MAAAA,CAAA,KAAY;UACnB,MAAM2B,KAAK,GAAG,MAAMrE,WAAW,CAACsE,gBAAgB,CAAC;YAC/CC,cAAc,EAAE,CAAC;YACjB1B,SAAS,EAAE,OAAO;YAClBC,aAAa,EAAGC,KAAK,IAAK;cACxB,IAAIA,KAAK,CAACC,IAAI,KAAKC,iBAAQ,CAACC,IAAI,CAACC,sBAAsB,EAAE;gBACvDjD,KAAK,CAAC;kBACJyB,KAAK,EAAEhC,OAAO,CAACyD,MAAM,CAACC,uBAAuB;kBAC7CC,OAAO,EAAE3D,OAAO,CAACyD,MAAM,CAACG,yBAAyB,CAC/C5D,OAAO,CAAC6D,MAAM,CAACgB,yBAAyB,EACxC7E,OAAO,CAAC6D,MAAM,CAACE,mBAAmB,CACnC;kBACDC,OAAO,EAAE,CAAC;oBAAEC,IAAI,EAAEjE,OAAO,CAACyD,MAAM,CAACS,oBAAoB;oBAAEnB,OAAO,EAAEA,CAAA,KAAMoB,iBAAQ,CAACC,YAAY;kBAAG,CAAC;gBACjG,CAAC,CAAC;cACJ,CAAC,MAAM;gBACLhD,KAAK,CAACiD,IAAI,CAACrE,OAAO,CAACsE,KAAK,CAACQ,wBAAwB,EAAE,OAAO,CAAC;cAC7D;YACF;UACF,CAAC,CAAC;UACF,IAAI,CAACJ,KAAK,IAAI,CAACA,KAAK,CAAC,CAAC,CAAC,EAAE;UAEzB,MAAM9C,aAAa,CAAC;YAAE4C,eAAe,EAAEE,KAAK,CAAC,CAAC;UAAE,CAAC,CAAC;QACpD;MACF,CAAC;IAEL,CAAC,CAAC;EACJ,CAAC,EAAE,CAAC1E,OAAO,EAAE4B,aAAa,CAAC,CAAC;EAE5B,MAAMvC,kBAAkB,GAAG,IAAAwC,kBAAW,EAAC,MAAM;IAC3CP,SAAS,CAAC;MACRyD,UAAU,EAAE,CACV;QAAE/C,KAAK,EAAEhC,OAAO,CAACiC,qBAAqB,CAAC+C,kBAAkB;QAAEjC,OAAO,EAAEhB;MAAkB,CAAC,EACvF;QAAEC,KAAK,EAAEhC,OAAO,CAACiC,qBAAqB,CAACgD,mBAAmB;QAAElC,OAAO,EAAEJ;MAAmB,CAAC;IAE7F,CAAC,CAAC;EACJ,CAAC,EAAE,CAAC3C,OAAO,EAAE2C,kBAAkB,EAAEZ,iBAAiB,CAAC,CAAC;EAEpD,oBACEjF,MAAA,CAAAa,OAAA,CAAAuH,aAAA,CAAC9H,eAAA,CAAAO,OAAc,qBACbb,MAAA,CAAAa,OAAA,CAAAuH,aAAA,CAACnG,2BAA2B,CAACC,QAAQ,CAACmG,QAAQ;IAC5CC,KAAK,EAAE;MACLlG,OAAO;MACPC,WAAW,EAAEa,OAAO,CAACiC,qBAAqB,CAACoD,YAAY;MACvDjG,WAAW,EAAEY,OAAO,CAACiC,qBAAqB,CAACqD,YAAY;MACvDjG;IACF;EAAE,GAEDM,QAAQ,CACqC,CACjC;AAErB,CAAC;AAACJ,OAAA,CAAAC,mCAAA,GAAAA,mCAAA"}