{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_chat","_uikitReactNativeFoundation","_uikitUtils","_useContext","_moduleContext","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","WARN_onPressMenuNotification","WARN_onPressMenuSearchInChannel","GroupChannelSettingsMenu","_ref","onPressMenuModeration","onPressMenuMembers","onPressMenuSearchInChannel","onPressMenuLeaveChannel","onPressMenuNotification","menuItemsCreator","menu","sdk","sbOptions","useSendbirdChat","channel","useContext","GroupChannelSettingsContexts","Fragment","STRINGS","useLocalization","colors","useUIKitTheme","__DEV__","uikit","groupChannel","enableMention","Logger","warn","uikitWithAppInfo","setting","enableMessageSearch","toggleNotification","myPushTriggerOption","setMyPushTriggerOption","PushTriggerOption","DEFAULT","OFF","onPressNotificationMenu","actionLabelNotificationMenu","actionItemNotificationMenu","useIIFE","getNotificationsLabel","ALL","GROUP_CHANNEL_SETTINGS","MENU_NOTIFICATION_LABEL_ON","MENU_NOTIFICATION_LABEL_OFF","MENTION_ONLY","MENU_NOTIFICATION_LABEL_MENTION_ONLY","conditionChaining","createElement","Icon","icon","color","onBackground01","Switch","value","onChangeValue","defaultMenuItems","visible","myRole","name","MENU_MODERATION","onPress","actionItem","MENU_NOTIFICATION","actionLabel","MENU_MEMBERS","String","memberCount","isEphemeral","push","MENU_SEARCH","iconColor","error","MENU_LEAVE_CHANNEL","leave","then","clearCachedMessages","url","catch","menuItems","View","map","MenuBar","disabled","iconBackgroundColor","_default","exports"],"sources":["GroupChannelSettingsMenu.tsx"],"sourcesContent":["import React, { useContext } from 'react';\nimport { View } from 'react-native';\n\nimport { PushTriggerOption } from '@sendbird/chat';\nimport type { MenuBarProps } from '@sendbird/uikit-react-native-foundation';\nimport { Icon, MenuBar, Switch, useUIKitTheme } from '@sendbird/uikit-react-native-foundation';\nimport { Logger, conditionChaining, useIIFE } from '@sendbird/uikit-utils';\n\nimport { useLocalization, useSendbirdChat } from '../../../hooks/useContext';\nimport { GroupChannelSettingsContexts } from '../module/moduleContext';\nimport type { GroupChannelSettingsProps } from '../types';\n\nlet WARN_onPressMenuNotification = false;\nlet WARN_onPressMenuSearchInChannel = false;\n\nconst GroupChannelSettingsMenu = ({\n  onPressMenuModeration,\n  onPressMenuMembers,\n  onPressMenuSearchInChannel,\n  onPressMenuLeaveChannel,\n  onPressMenuNotification,\n  menuItemsCreator = (menu) => menu,\n}: GroupChannelSettingsProps['Menu']) => {\n  const { sdk, sbOptions } = useSendbirdChat();\n  const { channel } = useContext(GroupChannelSettingsContexts.Fragment);\n  const { STRINGS } = useLocalization();\n  const { colors } = useUIKitTheme();\n\n  if (\n    __DEV__ &&\n    !WARN_onPressMenuNotification &&\n    !onPressMenuNotification &&\n    sbOptions.uikit.groupChannel.channel.enableMention\n  ) {\n    Logger.warn('If you are using mention, make sure to pass the `onPressMenuNotification` prop');\n    WARN_onPressMenuNotification = true;\n  }\n\n  if (\n    __DEV__ &&\n    !WARN_onPressMenuSearchInChannel &&\n    !onPressMenuSearchInChannel &&\n    sbOptions.uikitWithAppInfo.groupChannel.setting.enableMessageSearch\n  ) {\n    Logger.warn('If you are using message search, make sure to pass the `onPressMenuSearchInChannel` prop');\n    WARN_onPressMenuSearchInChannel = true;\n  }\n\n  const toggleNotification = async () => {\n    if (channel.myPushTriggerOption === 'off') {\n      await channel.setMyPushTriggerOption(PushTriggerOption.DEFAULT);\n    } else {\n      await channel.setMyPushTriggerOption(PushTriggerOption.OFF);\n    }\n  };\n\n  const { onPressNotificationMenu, actionLabelNotificationMenu, actionItemNotificationMenu } = useIIFE(() => {\n    const getNotificationsLabel = () => {\n      switch (channel.myPushTriggerOption) {\n        case PushTriggerOption.ALL:\n        case PushTriggerOption.DEFAULT:\n          return STRINGS.GROUP_CHANNEL_SETTINGS.MENU_NOTIFICATION_LABEL_ON;\n        case PushTriggerOption.OFF:\n          return STRINGS.GROUP_CHANNEL_SETTINGS.MENU_NOTIFICATION_LABEL_OFF;\n        case PushTriggerOption.MENTION_ONLY:\n          return STRINGS.GROUP_CHANNEL_SETTINGS.MENU_NOTIFICATION_LABEL_MENTION_ONLY;\n      }\n    };\n\n    return {\n      actionLabelNotificationMenu: getNotificationsLabel(),\n      actionItemNotificationMenu: conditionChaining(\n        [sbOptions.uikit.groupChannel.channel.enableMention],\n        [\n          <Icon icon={'chevron-right'} color={colors.onBackground01} />,\n          <Switch value={channel.myPushTriggerOption !== 'off'} onChangeValue={toggleNotification} />,\n        ],\n      ),\n      onPressNotificationMenu: () => {\n        if (sbOptions.uikit.groupChannel.channel.enableMention) onPressMenuNotification?.();\n        else toggleNotification();\n      },\n    };\n  });\n\n  const defaultMenuItems: MenuBarProps[] = [\n    {\n      icon: 'moderation',\n      visible: channel.myRole === 'operator',\n      name: STRINGS.GROUP_CHANNEL_SETTINGS.MENU_MODERATION,\n      onPress: () => onPressMenuModeration(),\n      actionItem: <Icon icon={'chevron-right'} color={colors.onBackground01} />,\n    },\n    {\n      icon: 'notifications',\n      name: STRINGS.GROUP_CHANNEL_SETTINGS.MENU_NOTIFICATION,\n      onPress: onPressNotificationMenu,\n      actionLabel: actionLabelNotificationMenu,\n      actionItem: actionItemNotificationMenu,\n    },\n    {\n      icon: 'members',\n      name: STRINGS.GROUP_CHANNEL_SETTINGS.MENU_MEMBERS,\n      onPress: () => onPressMenuMembers(),\n      actionLabel: String(channel.memberCount),\n      actionItem: <Icon icon={'chevron-right'} color={colors.onBackground01} />,\n    },\n  ];\n\n  if (sbOptions.uikitWithAppInfo.groupChannel.setting.enableMessageSearch && !channel.isEphemeral) {\n    defaultMenuItems.push({\n      icon: 'search',\n      name: STRINGS.GROUP_CHANNEL_SETTINGS.MENU_SEARCH,\n      onPress: () => onPressMenuSearchInChannel?.(),\n    });\n  }\n\n  defaultMenuItems.push({\n    icon: 'leave',\n    iconColor: colors.error,\n    name: STRINGS.GROUP_CHANNEL_SETTINGS.MENU_LEAVE_CHANNEL,\n    onPress: () => {\n      channel.leave().then(() => {\n        onPressMenuLeaveChannel();\n        sdk.clearCachedMessages([channel.url]).catch();\n      });\n    },\n  });\n\n  const menuItems = menuItemsCreator(defaultMenuItems);\n\n  return (\n    <View>\n      {menuItems.map((menu) => {\n        return (\n          <MenuBar\n            key={menu.name}\n            onPress={menu.onPress}\n            name={menu.name}\n            disabled={menu.disabled}\n            visible={menu.visible}\n            icon={menu.icon}\n            iconColor={menu.iconColor}\n            iconBackgroundColor={menu.iconBackgroundColor}\n            actionLabel={menu.actionLabel}\n            actionItem={menu.actionItem}\n          />\n        );\n      })}\n    </View>\n  );\n};\n\nexport default GroupChannelSettingsMenu;\n"],"mappings":"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"}