{"version":3,"names":["_InternalLocalCacheStorage","_interopRequireDefault","require","obj","__esModule","default","_defineProperty","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","MemoryStorage","constructor","getAllKeys","keys","_data","getItem","removeItem","setItem","EmojiManager","internalStorage","arguments","length","InternalLocalCacheStorage","container","get","emojiStorage","strItem","freeze","JSON","parse","set","stringify","emojiContainer","category","emojiCategories","_emojiCategoryMap","id","emoji","emojis","_allEmojiMap","_allEmoji","values","emojiCategoryMap","allEmojiMap","allEmoji","emojiHash","_this$emojiStorage$co","_default","exports"],"sources":["EmojiManager.ts"],"sourcesContent":["import type { SendbirdEmoji, SendbirdEmojiCategory, SendbirdEmojiContainer } from '@sendbird/uikit-utils';\n\nimport type { LocalCacheStorage } from '../types';\nimport InternalLocalCacheStorage from './InternalLocalCacheStorage';\n\nclass MemoryStorage implements LocalCacheStorage {\n  _data: Record<string, string> = {};\n\n  async getAllKeys(): Promise<readonly string[] | string[]> {\n    return Object.keys(this._data);\n  }\n\n  async getItem(key: string): Promise<string | null> {\n    return this._data[key];\n  }\n\n  async removeItem(key: string): Promise<void> {\n    delete this._data[key];\n  }\n\n  async setItem(key: string, value: string): Promise<void> {\n    this._data[key] = value;\n  }\n}\n\nclass EmojiManager {\n  static key = 'sendbird-uikit@emoji-manager';\n\n  constructor(\n    private internalStorage: InternalLocalCacheStorage = new InternalLocalCacheStorage(new MemoryStorage()),\n  ) {}\n\n  private emojiStorage = {\n    container: null as null | SendbirdEmojiContainer,\n    get: async () => {\n      if (!this.emojiStorage.container) {\n        const strItem = await this.internalStorage.getItem(EmojiManager.key);\n        if (strItem) this.emojiStorage.container = Object.freeze(JSON.parse(strItem));\n      }\n      return this.emojiStorage.container;\n    },\n    set: async (container: SendbirdEmojiContainer) => {\n      this.emojiStorage.container = Object.freeze(container);\n      await this.internalStorage.setItem(EmojiManager.key, JSON.stringify(container));\n    },\n  };\n\n  private _emojiCategoryMap: Record<string, SendbirdEmojiCategory> = {};\n  public get emojiCategoryMap() {\n    return this._emojiCategoryMap;\n  }\n\n  private _allEmojiMap: Record<string, SendbirdEmoji> = {};\n  public get allEmojiMap() {\n    return this._allEmojiMap;\n  }\n\n  private _allEmoji: SendbirdEmoji[] = [];\n  public get allEmoji() {\n    return this._allEmoji;\n  }\n\n  public init = async (emojiContainer?: SendbirdEmojiContainer) => {\n    if (emojiContainer) await this.emojiStorage.set(emojiContainer);\n\n    const container = await this.emojiStorage.get();\n\n    if (container) {\n      for (const category of container.emojiCategories) {\n        this._emojiCategoryMap[category.id] = category;\n        for (const emoji of category.emojis) {\n          this._allEmojiMap[emoji.key] = emoji;\n        }\n      }\n      this._allEmoji = Object.values(this._allEmojiMap);\n    }\n  };\n\n  public get emojiHash() {\n    return this.emojiStorage.container?.emojiHash;\n  }\n}\n\nexport default EmojiManager;\n"],"mappings":"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"}