{"version":3,"names":["_react","_interopRequireWildcard","require","_uikitUtils","_ReactionBottomSheets","_LocalizationCtx","_SendbirdChatCtx","_UserProfileCtx","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_extends","assign","bind","target","i","arguments","length","source","apply","ReactionContext","React","createContext","exports","ReactionProvider","_ref","children","onPressUserProfile","chatCtx","useContext","SendbirdChatContext","localizationCtx","LocalizationContext","userProfileCtx","UserProfileContext","Error","state","setState","useReducer","prev","next","reactionListVisible","setReactionListVisible","useState","reactionUserListVisible","setReactionUserListVisible","reactionUserListFocusIndex","setReactionUserListFocusIndex","closeResolver","useRef","NOOP","openReactionList","useCallback","params","openReactionUserList","_ref2","channel","message","focusIndex","isGroupChannel","isSuper","updateReactionFocusedItem","createOnCloseWithResolver","callback","Promise","resolve","current","reactionCtx","sheetProps","show","onDismiss","_closeResolver$curren","createElement","Provider","value","ReactionBottomSheets","UserList","visible","onClose","ReactionList"],"sources":["ReactionCtx.tsx"],"sourcesContent":["import React, { useCallback, useContext, useReducer, useRef, useState } from 'react';\n\nimport type { SendbirdBaseChannel, SendbirdBaseMessage } from '@sendbird/uikit-utils';\nimport { NOOP } from '@sendbird/uikit-utils';\n\nimport { ReactionBottomSheetProps, ReactionBottomSheets } from '../components/ReactionBottomSheets';\nimport { LocalizationContext } from '../contexts/LocalizationCtx';\nimport { SendbirdChatContext } from '../contexts/SendbirdChatCtx';\nimport { UserProfileContext } from '../contexts/UserProfileCtx';\n\ntype State = {\n  message?: SendbirdBaseMessage;\n  channel?: SendbirdBaseChannel;\n};\nexport type ReactionContextType = {\n  openReactionList(param: Required<State>): void;\n  openReactionUserList(param: Required<State> & { focusIndex?: number }): void;\n  updateReactionFocusedItem(param?: State): void;\n  focusIndex: number;\n} & State;\n\ntype Props = React.PropsWithChildren<{\n  onPressUserProfile?: ReactionBottomSheetProps['onPressUserProfile'];\n}>;\n\nexport const ReactionContext = React.createContext<ReactionContextType | null>(null);\nexport const ReactionProvider = ({ children, onPressUserProfile }: Props) => {\n  const chatCtx = useContext(SendbirdChatContext);\n  const localizationCtx = useContext(LocalizationContext);\n  const userProfileCtx = useContext(UserProfileContext);\n  if (!chatCtx) throw new Error('SendbirdChatContext is not provided');\n  if (!localizationCtx) throw new Error('LocalizationContext is not provided');\n  if (!userProfileCtx) throw new Error('UserProfileContext is not provided');\n\n  const [state, setState] = useReducer((prev: State, next: State) => ({ ...prev, ...next }), {});\n  const [reactionListVisible, setReactionListVisible] = useState(false);\n  const [reactionUserListVisible, setReactionUserListVisible] = useState(false);\n  const [reactionUserListFocusIndex, setReactionUserListFocusIndex] = useState(0);\n\n  const closeResolver = useRef<() => void>(NOOP);\n\n  const openReactionList: ReactionContextType['openReactionList'] = useCallback((params) => {\n    setState(params);\n    setReactionListVisible(true);\n  }, []);\n\n  const openReactionUserList: ReactionContextType['openReactionUserList'] = useCallback(\n    ({ channel, message, focusIndex = 0 }) => {\n      // NOTE: We don't support reaction user list for supergroup channel\n      if (channel.isGroupChannel() && channel.isSuper) return;\n\n      setState({ channel, message });\n      setReactionUserListFocusIndex(focusIndex);\n      setReactionUserListVisible(true);\n    },\n    [],\n  );\n\n  const updateReactionFocusedItem: ReactionContextType['updateReactionFocusedItem'] = useCallback((params) => {\n    if (params) setState(params);\n    else setState({});\n  }, []);\n\n  const createOnCloseWithResolver = (callback: () => void) => {\n    return () => {\n      return new Promise<void>((resolve) => {\n        closeResolver.current = resolve;\n        callback();\n      });\n    };\n  };\n\n  const reactionCtx = {\n    ...state,\n    openReactionList,\n    openReactionUserList,\n    updateReactionFocusedItem,\n    focusIndex: reactionUserListFocusIndex,\n  };\n\n  const sheetProps: Omit<ReactionBottomSheetProps, 'visible' | 'onClose'> = {\n    chatCtx,\n    reactionCtx,\n    localizationCtx,\n    onPressUserProfile: onPressUserProfile ?? userProfileCtx.show,\n    onDismiss: () => {\n      setState({});\n      closeResolver.current?.();\n    },\n  };\n\n  return (\n    <ReactionContext.Provider value={reactionCtx}>\n      {children}\n      <ReactionBottomSheets.UserList\n        {...sheetProps}\n        visible={reactionUserListVisible}\n        onClose={createOnCloseWithResolver(() => setReactionUserListVisible(false))}\n      />\n      <ReactionBottomSheets.ReactionList\n        {...sheetProps}\n        visible={reactionListVisible}\n        onClose={createOnCloseWithResolver(() => setReactionListVisible(false))}\n      />\n    </ReactionContext.Provider>\n  );\n};\n"],"mappings":"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"}