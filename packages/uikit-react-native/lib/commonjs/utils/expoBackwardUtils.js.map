{"version":3,"names":["_normalizeFile","_interopRequireDefault","require","obj","__esModule","default","expoBackwardUtils","imagePicker","isCanceled","result","canceled","cancelled","toFilePickerResponses","fsModule","assets","promises","map","_ref","fileName","name","fileSize","size","type","uri","normalizeFile","Promise","all","fileInfo","getInfoAsync","response","toFileSize","documentPicker","_ref2","mimeType","info","_default","exports"],"sources":["expoBackwardUtils.ts"],"sourcesContent":["import type * as ExpoDocumentPicker from 'expo-document-picker';\nimport type * as ExpoFs from 'expo-file-system';\nimport type * as ExpoImagePicker from 'expo-image-picker';\n\nimport type { FilePickerResponse } from '../platform/types';\nimport normalizeFile from './normalizeFile';\n\nconst expoBackwardUtils = {\n  imagePicker: {\n    isCanceled(result: ExpoImagePicker.ImagePickerResult) {\n      // @ts-expect-error backward compatibility\n      return result.canceled ?? result.cancelled;\n    },\n    async toFilePickerResponses(\n      result: ExpoImagePicker.ImagePickerResult,\n      fsModule: typeof ExpoFs,\n    ): Promise<FilePickerResponse[]> {\n      if (result.assets) {\n        const assets = result.assets || [];\n        const promises = assets.map(({ fileName: name, fileSize: size, type, uri }) =>\n          normalizeFile({ uri, size, name, type }),\n        );\n\n        return Promise.all(promises);\n      } else if ('uri' in result && typeof result.uri === 'string') {\n        const fileInfo = await fsModule.getInfoAsync(result.uri);\n        const response = await normalizeFile({ uri: result.uri, size: expoBackwardUtils.toFileSize(fileInfo) });\n        return [response];\n      } else {\n        return [];\n      }\n    },\n  },\n  documentPicker: {\n    isCanceled(result: ExpoDocumentPicker.DocumentPickerResult) {\n      // @ts-expect-error backward compatibility\n      return result.canceled ?? result.type === 'cancel';\n    },\n    async toFilePickerResponses(result: ExpoDocumentPicker.DocumentPickerResult): Promise<FilePickerResponse[]> {\n      if (result.assets) {\n        const assets = result.assets || [];\n        const promises = assets.map(({ name, size, mimeType, uri }) =>\n          normalizeFile({ uri, size, name, type: mimeType }),\n        );\n\n        return Promise.all(promises);\n      } else if ('uri' in result && typeof result.uri === 'string') {\n        // @ts-expect-error backward compatibility\n        const { mimeType, uri, size, name } = result;\n        const response = await normalizeFile({ uri, size, name, type: mimeType });\n\n        return [response];\n      } else {\n        return [];\n      }\n    },\n  },\n  toFileSize(info: ExpoFs.FileInfo) {\n    if ('size' in info) {\n      return info.size;\n    } else {\n      return 0;\n    }\n  },\n};\n\nexport default expoBackwardUtils;\n"],"mappings":"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"}