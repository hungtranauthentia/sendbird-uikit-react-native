{"version":3,"names":["_react","_interopRequireDefault","require","_reactNative","_uikitReactNativeFoundation","_uikitUtils","_constants","_useContext","_ReactionRoundedButton","obj","__esModule","default","NUM_COL","REACTION_MORE_KEY","getUserReacted","reaction","userId","arguments","length","undefined","UNKNOWN_USER_ID","userIds","indexOf","createOnPressReaction","channel","message","reacted","deleteReaction","key","addReaction","createReactionButtons","getEmoji","emojiLimit","onOpenReactionList","onOpenReactionUserList","currentUserId","reactions","buttons","map","index","isNotLastOfRow","isNotLastOfCol","createElement","Pressable","onPress","onLongPress","delayLongPress","DEFAULT_LONG_PRESS_DELAY","_ref","pressed","url","count","getReactionCount","style","styles","marginRight","marginBottom","push","_ref2","More","MessageReactionAddon","_ref3","_message$reactions","colors","useUIKitTheme","emojiManager","currentUser","useSendbirdChat","openReactionList","openReactionUserList","useReaction","reactionButtons","allEmojiMap","allEmoji","focusIndex","reactionContainer","backgroundColor","background","borderColor","ui","rounded","enabled","createStyleSheet","alignItems","flexDirection","flexWrap","padding","borderRadius","borderWidth","_default","exports"],"sources":["MessageReactionAddon.tsx"],"sourcesContent":["import React from 'react';\nimport { Pressable } from 'react-native';\n\nimport type { Emoji } from '@sendbird/chat';\nimport { createStyleSheet, useUIKitTheme } from '@sendbird/uikit-react-native-foundation';\nimport type { SendbirdBaseChannel, SendbirdBaseMessage, SendbirdReaction } from '@sendbird/uikit-utils';\nimport { getReactionCount } from '@sendbird/uikit-utils';\n\nimport { DEFAULT_LONG_PRESS_DELAY, UNKNOWN_USER_ID } from '../../constants';\nimport { useReaction, useSendbirdChat } from '../../hooks/useContext';\nimport ReactionRoundedButton from './ReactionRoundedButton';\n\nconst NUM_COL = 4;\nconst REACTION_MORE_KEY = 'reaction-more-button';\n\nconst getUserReacted = (reaction: SendbirdReaction, userId = UNKNOWN_USER_ID) => {\n  return reaction.userIds.indexOf(userId) > -1;\n};\n\nconst createOnPressReaction = (\n  reaction: SendbirdReaction,\n  channel: SendbirdBaseChannel,\n  message: SendbirdBaseMessage,\n  reacted: boolean,\n) => {\n  return () => {\n    if (reacted) {\n      return channel.deleteReaction(message, reaction.key);\n    } else {\n      return channel.addReaction(message, reaction.key);\n    }\n  };\n};\n\nconst createReactionButtons = (\n  channel: SendbirdBaseChannel,\n  message: SendbirdBaseMessage,\n  getEmoji: (key: string) => Emoji,\n  emojiLimit: number,\n  onOpenReactionList: () => void,\n  onOpenReactionUserList: (focusIndex: number) => void,\n  currentUserId?: string,\n) => {\n  const reactions = message.reactions ?? [];\n  const buttons = reactions.map((reaction, index) => {\n    const isNotLastOfRow = index % NUM_COL !== NUM_COL - 1;\n    const isNotLastOfCol = index < NUM_COL && reactions.length >= NUM_COL;\n    return (\n      <Pressable\n        key={reaction.key}\n        onPress={createOnPressReaction(reaction, channel, message, getUserReacted(reaction, currentUserId))}\n        onLongPress={() => onOpenReactionUserList(index)}\n        delayLongPress={DEFAULT_LONG_PRESS_DELAY}\n      >\n        {({ pressed }) => (\n          <ReactionRoundedButton\n            url={getEmoji(reaction.key).url}\n            count={getReactionCount(reaction)}\n            reacted={pressed || getUserReacted(reaction, currentUserId)}\n            style={[isNotLastOfRow && styles.marginRight, isNotLastOfCol && styles.marginBottom]}\n          />\n        )}\n      </Pressable>\n    );\n  });\n  if (buttons.length < emojiLimit) {\n    buttons.push(\n      <Pressable key={REACTION_MORE_KEY} onPress={onOpenReactionList}>\n        {({ pressed }) => <ReactionRoundedButton.More pressed={pressed} />}\n      </Pressable>,\n    );\n  }\n\n  return buttons;\n};\n\nconst MessageReactionAddon = ({ channel, message }: { channel: SendbirdBaseChannel; message: SendbirdBaseMessage }) => {\n  const { colors } = useUIKitTheme();\n  const { emojiManager, currentUser } = useSendbirdChat();\n  const { openReactionList, openReactionUserList } = useReaction();\n\n  if (!message.reactions?.length) return null;\n\n  const reactionButtons = createReactionButtons(\n    channel,\n    message,\n    (key) => emojiManager.allEmojiMap[key],\n    emojiManager.allEmoji.length,\n    () => openReactionList({ channel, message }),\n    (focusIndex) => openReactionUserList({ channel, message, focusIndex }),\n    currentUser?.userId,\n  );\n\n  return (\n    <Pressable\n      style={[\n        styles.reactionContainer,\n        { backgroundColor: colors.background, borderColor: colors.ui.reaction.rounded.enabled.background },\n      ]}\n    >\n      {reactionButtons}\n    </Pressable>\n  );\n};\n\nconst styles = createStyleSheet({\n  reactionContainer: {\n    alignItems: 'stretch',\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    padding: 8,\n    borderRadius: 16,\n    borderWidth: 1,\n  },\n  marginRight: {\n    marginRight: 4.5,\n  },\n  marginBottom: {\n    marginBottom: 4,\n  },\n});\n\nexport default MessageReactionAddon;\n"],"mappings":"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"}