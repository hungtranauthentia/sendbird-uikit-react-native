{"version":3,"names":["_react","_interopRequireDefault","require","_reactNative","_uikitChatHooks","_uikitUtils","_StatusComposition","_UserSelectableBar","_createUserListModule","_useContext","obj","__esModule","default","createGroupChannelCreateFragment","initModule","UserListModule","createUserListModule","_ref","onPressHeaderLeft","onBeforeCreateChannel","PASS","onCreateChannel","sortComparator","queryCreator","channelType","renderUser","sdk","currentUser","useSendbirdChat","STRINGS","useLocalization","users","refreshing","loading","error","refresh","next","useUserList","_renderUser","useFreshCallback","user","selectedUsers","setSelectedUsers","hasRequiredKey","Error","isMe","userId","userIdx","findIndex","u","isSelected","createElement","TouchableOpacity","activeOpacity","onPress","_ref2","draft","splice","push","uri","profileUrl","name","nickname","LABELS","USER_NO_NAME","selected","disabled","Provider","headerRight","GROUP_CHANNEL_CREATE","HEADER_RIGHT","headerTitle","HEADER_TITLE","Header","onPressHeaderRight","params","getDefaultGroupChannelCreateParams","invitedUserIds","map","it","currentUserId","isBroadcast","isSuper","processedParams","channel","groupChannel","createChannel","Boolean","LoadingComponent","StatusLoading","ErrorComponent","StatusError","onPressRetry","List","onLoadNext","onRefresh","ListEmptyComponent","StatusEmpty","_default","exports"],"sources":["createGroupChannelCreateFragment.tsx"],"sourcesContent":["import React from 'react';\nimport { TouchableOpacity } from 'react-native';\n\nimport { useUserList } from '@sendbird/uikit-chat-hooks';\nimport {\n  PASS,\n  SendbirdUser,\n  UserStruct,\n  getDefaultGroupChannelCreateParams,\n  useFreshCallback,\n} from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserSelectableBar from '../components/UserSelectableBar';\nimport type { GroupChannelCreateFragment } from '../domain/groupChannelUserList/types';\nimport createUserListModule from '../domain/userList/module/createUserListModule';\nimport type { UserListModule } from '../domain/userList/types';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\nconst createGroupChannelCreateFragment = <UserType extends UserStruct>(\n  initModule?: Partial<UserListModule<UserType>>,\n): GroupChannelCreateFragment<UserType> => {\n  const UserListModule = createUserListModule<UserType>(initModule);\n\n  return ({\n    onPressHeaderLeft,\n    onBeforeCreateChannel = PASS,\n    onCreateChannel,\n    sortComparator,\n    queryCreator,\n    channelType = 'GROUP',\n    renderUser,\n  }) => {\n    const { sdk, currentUser } = useSendbirdChat();\n    const { STRINGS } = useLocalization();\n    const { users, refreshing, loading, error, refresh, next } = useUserList(sdk, {\n      queryCreator,\n      sortComparator,\n    });\n\n    const _renderUser: NonNullable<typeof renderUser> = useFreshCallback((user, selectedUsers, setSelectedUsers) => {\n      if (queryCreator && !renderUser) {\n        const hasRequiredKey = 'profileUrl' in user && 'nickname' in user;\n        if (!hasRequiredKey) throw new Error('You should provide \"renderUser\" when providing \"queryCreator\"');\n      }\n\n      if (renderUser) return renderUser(user, selectedUsers, setSelectedUsers);\n\n      const isMe = user.userId === currentUser?.userId;\n      if (isMe) return null;\n\n      const userIdx = selectedUsers.findIndex((u) => u.userId === user.userId);\n      const isSelected = userIdx > -1;\n\n      return (\n        <TouchableOpacity\n          activeOpacity={0.7}\n          onPress={() => {\n            setSelectedUsers(([...draft]) => {\n              if (isSelected) draft.splice(userIdx, 1);\n              else draft.push(user);\n              return draft;\n            });\n          }}\n        >\n          <UserSelectableBar\n            uri={(user as unknown as SendbirdUser).profileUrl}\n            name={(user as unknown as SendbirdUser).nickname || STRINGS.LABELS.USER_NO_NAME}\n            selected={isSelected}\n            disabled={false}\n          />\n        </TouchableOpacity>\n      );\n    });\n\n    return (\n      <UserListModule.Provider\n        headerRight={(selectedUsers) => STRINGS.GROUP_CHANNEL_CREATE.HEADER_RIGHT({ selectedUsers })}\n        headerTitle={STRINGS.GROUP_CHANNEL_CREATE.HEADER_TITLE}\n      >\n        <UserListModule.Header\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={async (users) => {\n            const params = getDefaultGroupChannelCreateParams({\n              invitedUserIds: users.map((it) => it.userId),\n              currentUserId: currentUser?.userId,\n            });\n\n            if (channelType === 'BROADCAST') params.isBroadcast = true;\n            if (channelType === 'SUPER_GROUP') params.isSuper = true;\n\n            const processedParams = await onBeforeCreateChannel(params, users);\n            const channel = await sdk.groupChannel.createChannel(processedParams);\n            onCreateChannel(channel);\n          }}\n        />\n        <StatusComposition\n          loading={loading}\n          error={Boolean(error)}\n          LoadingComponent={<UserListModule.StatusLoading />}\n          ErrorComponent={<UserListModule.StatusError onPressRetry={() => refresh()} />}\n        >\n          <UserListModule.List\n            onLoadNext={next}\n            users={users}\n            renderUser={_renderUser}\n            onRefresh={refresh}\n            refreshing={refreshing}\n            ListEmptyComponent={<UserListModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </UserListModule.Provider>\n    );\n  };\n};\n\nexport default createGroupChannelCreateFragment;\n"],"mappings":"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"}