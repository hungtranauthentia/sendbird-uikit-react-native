{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_uikitChatHooks","_StatusComposition","_interopRequireDefault","_UserSelectableBar","_createUserListModule","_useContext","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","createGroupChannelRegisterOperatorFragment","initModule","UserListModule","createUserListModule","_ref","channel","onPressHeaderLeft","sortComparator","renderUser","onPressHeaderRight","queryCreator","createMemberListQuery","limit","sdk","currentUser","useSendbirdChat","STRINGS","useLocalization","users","refreshing","refresh","next","error","loading","useUserList","_renderUser","useCallback","user","selectedUsers","setSelectedUsers","userIdx","findIndex","u","userId","isSelected","isOperator","role","createElement","TouchableOpacity","activeOpacity","disabled","onPress","_ref2","draft","splice","push","uri","profileUrl","name","nickname","LABELS","USER_NO_NAME","USER_BAR_ME_POSTFIX","selected","Provider","headerRight","GROUP_CHANNEL_REGISTER_OPERATOR","HEADER_RIGHT","headerTitle","HEADER_TITLE","Header","shouldActivateHeaderRight","length","addOperators","map","it","Boolean","LoadingComponent","StatusLoading","ErrorComponent","StatusError","onPressRetry","List","onLoadNext","onRefresh","ListEmptyComponent","StatusEmpty","_default","exports"],"sources":["createGroupChannelRegisterOperatorFragment.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { TouchableOpacity } from 'react-native';\n\nimport { useUserList } from '@sendbird/uikit-chat-hooks';\nimport type { SendbirdMember } from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserSelectableBar from '../components/UserSelectableBar';\nimport type { GroupChannelRegisterOperatorFragment } from '../domain/groupChannelUserList/types';\nimport createUserListModule from '../domain/userList/module/createUserListModule';\nimport type { UserListModule } from '../domain/userList/types';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\nconst createGroupChannelRegisterOperatorFragment = (\n  initModule?: Partial<UserListModule<SendbirdMember>>,\n): GroupChannelRegisterOperatorFragment => {\n  const UserListModule = createUserListModule<SendbirdMember>(initModule);\n\n  return ({\n    channel,\n    onPressHeaderLeft,\n    sortComparator,\n    renderUser,\n    onPressHeaderRight,\n    queryCreator = () => channel.createMemberListQuery({ limit: 20 }),\n  }) => {\n    const { sdk, currentUser } = useSendbirdChat();\n    const { STRINGS } = useLocalization();\n    const { users, refreshing, refresh, next, error, loading } = useUserList(sdk, { queryCreator, sortComparator });\n\n    const _renderUser: NonNullable<typeof renderUser> = useCallback(\n      (user, selectedUsers, setSelectedUsers) => {\n        if (renderUser) return renderUser(user, selectedUsers, setSelectedUsers);\n\n        const userIdx = selectedUsers.findIndex((u) => u.userId === user.userId);\n        const isSelected = userIdx > -1;\n        const isOperator = user.role === 'operator';\n\n        return (\n          <TouchableOpacity\n            activeOpacity={0.7}\n            disabled={isOperator}\n            onPress={() => {\n              setSelectedUsers(([...draft]) => {\n                if (isSelected) draft.splice(userIdx, 1);\n                else draft.push(user);\n                return draft;\n              });\n            }}\n          >\n            <UserSelectableBar\n              uri={user.profileUrl}\n              name={\n                (user.nickname || STRINGS.LABELS.USER_NO_NAME) +\n                (user.userId === currentUser?.userId ? STRINGS.LABELS.USER_BAR_ME_POSTFIX : '')\n              }\n              selected={isOperator || isSelected}\n              disabled={isOperator}\n            />\n          </TouchableOpacity>\n        );\n      },\n      [channel, renderUser],\n    );\n    return (\n      <UserListModule.Provider\n        headerRight={(selectedUsers) => STRINGS.GROUP_CHANNEL_REGISTER_OPERATOR.HEADER_RIGHT({ selectedUsers })}\n        headerTitle={STRINGS.GROUP_CHANNEL_REGISTER_OPERATOR.HEADER_TITLE}\n      >\n        <UserListModule.Header\n          shouldActivateHeaderRight={(selectedUsers) => selectedUsers.length > 0}\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={async (users) => {\n            await channel.addOperators(users.map((it) => it.userId));\n            onPressHeaderRight(channel);\n          }}\n        />\n        <StatusComposition\n          loading={loading}\n          error={Boolean(error)}\n          LoadingComponent={<UserListModule.StatusLoading />}\n          ErrorComponent={<UserListModule.StatusError onPressRetry={() => refresh()} />}\n        >\n          <UserListModule.List\n            onLoadNext={next}\n            users={users}\n            renderUser={_renderUser}\n            onRefresh={refresh}\n            refreshing={refreshing}\n            ListEmptyComponent={<UserListModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </UserListModule.Provider>\n    );\n  };\n};\n\nexport default createGroupChannelRegisterOperatorFragment;\n"],"mappings":"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"}