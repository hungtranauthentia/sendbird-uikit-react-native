{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_uikitChatHooks","_StatusComposition","_interopRequireDefault","_UserSelectableBar","_createUserListModule","_useContext","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","createOpenChannelRegisterOperatorFragment","initModule","UserListModule","createUserListModule","_ref","channel","onPressHeaderLeft","sortComparator","renderUser","onPressHeaderRight","queryCreator","createParticipantListQuery","limit","sdk","currentUser","useSendbirdChat","STRINGS","useLocalization","users","refreshing","refresh","next","error","loading","useUserList","_renderUser","useCallback","user","selectedUsers","setSelectedUsers","userIdx","findIndex","u","userId","isSelected","isOperator","createElement","TouchableOpacity","activeOpacity","disabled","onPress","_ref2","draft","splice","push","uri","profileUrl","name","nickname","LABELS","USER_NO_NAME","USER_BAR_ME_POSTFIX","selected","Provider","headerRight","OPEN_CHANNEL_REGISTER_OPERATOR","HEADER_RIGHT","headerTitle","HEADER_TITLE","Header","shouldActivateHeaderRight","length","addOperators","map","it","Boolean","LoadingComponent","StatusLoading","ErrorComponent","StatusError","onPressRetry","List","onLoadNext","onRefresh","ListEmptyComponent","StatusEmpty","_default","exports"],"sources":["createOpenChannelRegisterOperatorFragment.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { TouchableOpacity } from 'react-native';\n\nimport { useUserList } from '@sendbird/uikit-chat-hooks';\nimport type { SendbirdParticipant } from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserSelectableBar from '../components/UserSelectableBar';\nimport type { OpenChannelRegisterOperatorFragment } from '../domain/openChannelUserList/types';\nimport createUserListModule from '../domain/userList/module/createUserListModule';\nimport type { UserListModule } from '../domain/userList/types';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\nconst createOpenChannelRegisterOperatorFragment = (\n  initModule?: Partial<UserListModule<SendbirdParticipant>>,\n): OpenChannelRegisterOperatorFragment => {\n  const UserListModule = createUserListModule<SendbirdParticipant>(initModule);\n\n  return ({\n    channel,\n    onPressHeaderLeft,\n    sortComparator,\n    renderUser,\n    onPressHeaderRight,\n    queryCreator = () => channel.createParticipantListQuery({ limit: 20 }),\n  }) => {\n    const { sdk, currentUser } = useSendbirdChat();\n    const { STRINGS } = useLocalization();\n    const { users, refreshing, refresh, next, error, loading } = useUserList(sdk, { queryCreator, sortComparator });\n\n    const _renderUser: NonNullable<typeof renderUser> = useCallback(\n      (user, selectedUsers, setSelectedUsers) => {\n        if (renderUser) return renderUser(user, selectedUsers, setSelectedUsers);\n\n        const userIdx = selectedUsers.findIndex((u) => u.userId === user.userId);\n        const isSelected = userIdx > -1;\n        const isOperator = channel.isOperator(user);\n\n        return (\n          <TouchableOpacity\n            activeOpacity={0.7}\n            disabled={isOperator}\n            onPress={() => {\n              setSelectedUsers(([...draft]) => {\n                if (isSelected) draft.splice(userIdx, 1);\n                else draft.push(user);\n                return draft;\n              });\n            }}\n          >\n            <UserSelectableBar\n              uri={user.profileUrl}\n              name={\n                (user.nickname || STRINGS.LABELS.USER_NO_NAME) +\n                (user.userId === currentUser?.userId ? STRINGS.LABELS.USER_BAR_ME_POSTFIX : '')\n              }\n              selected={isOperator || isSelected}\n              disabled={isOperator}\n            />\n          </TouchableOpacity>\n        );\n      },\n      [channel, renderUser],\n    );\n\n    return (\n      <UserListModule.Provider\n        headerRight={(selectedUsers) => STRINGS.OPEN_CHANNEL_REGISTER_OPERATOR.HEADER_RIGHT({ selectedUsers })}\n        headerTitle={STRINGS.OPEN_CHANNEL_REGISTER_OPERATOR.HEADER_TITLE}\n      >\n        <UserListModule.Header\n          shouldActivateHeaderRight={(selectedUsers) => selectedUsers.length > 0}\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={async (users) => {\n            await channel.addOperators(users.map((it) => it.userId));\n            onPressHeaderRight(channel);\n          }}\n        />\n        <StatusComposition\n          loading={loading}\n          error={Boolean(error)}\n          LoadingComponent={<UserListModule.StatusLoading />}\n          ErrorComponent={<UserListModule.StatusError onPressRetry={() => refresh()} />}\n        >\n          <UserListModule.List\n            onLoadNext={next}\n            users={users as SendbirdParticipant[]}\n            renderUser={_renderUser}\n            onRefresh={refresh}\n            refreshing={refreshing}\n            ListEmptyComponent={<UserListModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </UserListModule.Provider>\n    );\n  };\n};\n\nexport default createOpenChannelRegisterOperatorFragment;\n"],"mappings":"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"}