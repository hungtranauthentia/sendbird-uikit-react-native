{"version":3,"names":["_react","_interopRequireDefault","require","_uikitChatHooks","_uikitReactNativeFoundation","_uikitUtils","_StatusComposition","_UserActionBar","_groupChannelOperators","_useContext","obj","__esModule","default","createGroupChannelOperatorsFragment","initModule","GroupChannelOperatorsModule","createGroupChannelOperatorsModule","_ref","channel","onPressHeaderLeft","onPressHeaderRight","renderUser","queryCreator","createOperatorListQuery","limit","handlerId","useUniqHandlerId","STRINGS","useLocalization","sdk","currentUser","useSendbirdChat","openMenu","useActionMenu","show","useUserProfile","users","deleteUser","upsertUser","loading","refresh","next","error","useUserList","useChannelHandler","onUserLeft","eventChannel","user","isDifferentChannel","userId","onUserBanned","onOperatorUpdated","updatedUsers","operatorsAdded","length","forEach","_renderUser","useFreshCallback","props","createElement","muted","uri","profileUrl","name","nickname","LABELS","USER_NO_NAME","USER_BAR_ME_POSTFIX","disabled","onPressAvatar","onPressActionMenu","ifOperator","myRole","title","menuItems","UNREGISTER_OPERATOR","onPress","removeOperators","then","Provider","Header","LoadingComponent","StatusLoading","Boolean","ErrorComponent","StatusError","onPressRetry","List","operators","onLoadNext","ListEmptyComponent","StatusEmpty","_default","exports"],"sources":["createGroupChannelOperatorsFragment.tsx"],"sourcesContent":["import React from 'react';\n\nimport { useChannelHandler, useUserList } from '@sendbird/uikit-chat-hooks';\nimport { useActionMenu } from '@sendbird/uikit-react-native-foundation';\nimport { ifOperator, isDifferentChannel, useFreshCallback, useUniqHandlerId } from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserActionBar from '../components/UserActionBar';\nimport { createGroupChannelOperatorsModule } from '../domain/groupChannelOperators';\nimport type { GroupChannelOperatorsFragment, GroupChannelOperatorsModule } from '../domain/groupChannelOperators/types';\nimport { useLocalization, useSendbirdChat, useUserProfile } from '../hooks/useContext';\n\nconst createGroupChannelOperatorsFragment = (\n  initModule?: Partial<GroupChannelOperatorsModule>,\n): GroupChannelOperatorsFragment => {\n  const GroupChannelOperatorsModule = createGroupChannelOperatorsModule(initModule);\n\n  return ({\n    channel,\n    onPressHeaderLeft,\n    onPressHeaderRight,\n    renderUser,\n    queryCreator = () => channel.createOperatorListQuery({ limit: 20 }),\n  }) => {\n    const handlerId = useUniqHandlerId('GroupChannelOperatorsFragment');\n\n    const { STRINGS } = useLocalization();\n    const { sdk, currentUser } = useSendbirdChat();\n    const { openMenu } = useActionMenu();\n    const { show } = useUserProfile();\n\n    const { users, deleteUser, upsertUser, loading, refresh, next, error } = useUserList(sdk, { queryCreator });\n\n    useChannelHandler(sdk, handlerId, {\n      onUserLeft(eventChannel, user) {\n        if (isDifferentChannel(eventChannel, channel)) return;\n        deleteUser(user.userId);\n      },\n      onUserBanned(eventChannel, user) {\n        if (isDifferentChannel(eventChannel, channel)) return;\n        deleteUser(user.userId);\n      },\n      onOperatorUpdated(eventChannel, updatedUsers) {\n        if (isDifferentChannel(eventChannel, channel)) return;\n        const operatorsAdded = users.length < updatedUsers.length;\n        if (operatorsAdded) updatedUsers.forEach(upsertUser);\n      },\n    });\n\n    const _renderUser: NonNullable<typeof renderUser> = useFreshCallback((props) => {\n      if (renderUser) return renderUser(props);\n\n      const { user } = props;\n      return (\n        <UserActionBar\n          muted={false}\n          uri={user.profileUrl}\n          name={\n            (user.nickname || STRINGS.LABELS.USER_NO_NAME) +\n            (user.userId === currentUser?.userId ? STRINGS.LABELS.USER_BAR_ME_POSTFIX : '')\n          }\n          disabled={user.userId === currentUser?.userId}\n          onPressAvatar={() => show(user)}\n          onPressActionMenu={ifOperator(channel.myRole, () => {\n            openMenu({\n              title: user.nickname || STRINGS.LABELS.USER_NO_NAME,\n              menuItems: [\n                {\n                  title: STRINGS.LABELS.UNREGISTER_OPERATOR,\n                  onPress: () => channel.removeOperators([user.userId]).then(() => deleteUser(user.userId)),\n                },\n              ],\n            });\n          })}\n        />\n      );\n    });\n\n    return (\n      <GroupChannelOperatorsModule.Provider channel={channel}>\n        <GroupChannelOperatorsModule.Header\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={onPressHeaderRight}\n        />\n\n        <StatusComposition\n          loading={loading}\n          LoadingComponent={<GroupChannelOperatorsModule.StatusLoading />}\n          error={Boolean(error)}\n          ErrorComponent={<GroupChannelOperatorsModule.StatusError onPressRetry={refresh} />}\n        >\n          <GroupChannelOperatorsModule.List\n            operators={users}\n            renderUser={_renderUser}\n            onLoadNext={next}\n            ListEmptyComponent={<GroupChannelOperatorsModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </GroupChannelOperatorsModule.Provider>\n    );\n  };\n};\n\nexport default createGroupChannelOperatorsFragment;\n"],"mappings":"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"}