{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_uikitChatHooks","_StatusComposition","_interopRequireDefault","_UserSelectableBar","_createUserListModule","_useContext","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","createGroupChannelInviteFragment","initModule","UserListModule","createUserListModule","_ref","channel","onPressHeaderLeft","onInviteMembers","sortComparator","queryCreator","renderUser","sdk","useSendbirdChat","STRINGS","useLocalization","users","refreshing","refresh","next","error","loading","useUserList","memberIds","shouldFilterMember","members","map","it","userId","_renderUser","useCallback","user","selectedUsers","setSelectedUsers","hasRequiredKey","Error","userIdxInMembers","indexOf","userIdxInSelectedUsers","findIndex","isMember","isSelected","createElement","TouchableOpacity","activeOpacity","disabled","onPress","_ref2","draft","splice","push","uri","profileUrl","name","nickname","LABELS","USER_NO_NAME","selected","Provider","headerRight","GROUP_CHANNEL_INVITE","HEADER_RIGHT","headerTitle","HEADER_TITLE","Header","onPressHeaderRight","userIds","updatedChannel","inviteWithUserIds","Boolean","LoadingComponent","StatusLoading","ErrorComponent","StatusError","onPressRetry","List","onLoadNext","onRefresh","ListEmptyComponent","StatusEmpty","isSuper","isBroadcast","_default","exports"],"sources":["createGroupChannelInviteFragment.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { TouchableOpacity } from 'react-native';\n\nimport { useUserList } from '@sendbird/uikit-chat-hooks';\nimport type { SendbirdGroupChannel, SendbirdUser, UserStruct } from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserSelectableBar from '../components/UserSelectableBar';\nimport type { GroupChannelInviteFragment } from '../domain/groupChannelUserList/types';\nimport createUserListModule from '../domain/userList/module/createUserListModule';\nimport type { UserListModule } from '../domain/userList/types';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\nconst createGroupChannelInviteFragment = <UserType extends UserStruct>(\n  initModule?: Partial<UserListModule<UserType>>,\n): GroupChannelInviteFragment<UserType> => {\n  const UserListModule = createUserListModule<UserType>(initModule);\n\n  return ({ channel, onPressHeaderLeft, onInviteMembers, sortComparator, queryCreator, renderUser }) => {\n    const { sdk } = useSendbirdChat();\n    const { STRINGS } = useLocalization();\n    const { users, refreshing, refresh, next, error, loading } = useUserList(sdk, {\n      queryCreator,\n      sortComparator,\n    });\n\n    const memberIds = shouldFilterMember(channel) ? channel.members.map((it) => it.userId) : [];\n\n    const _renderUser: NonNullable<typeof renderUser> = useCallback(\n      (user, selectedUsers, setSelectedUsers) => {\n        if (queryCreator && !renderUser) {\n          const hasRequiredKey = 'profileUrl' in user && 'nickname' in user;\n          if (!hasRequiredKey) throw new Error('You should provide \"renderUser\" when providing \"queryCreator\"');\n        }\n\n        if (renderUser) return renderUser(user, selectedUsers, setSelectedUsers);\n\n        const userIdxInMembers = memberIds.indexOf(user.userId);\n        const userIdxInSelectedUsers = selectedUsers.findIndex((it) => it.userId === user.userId);\n\n        const isMember = userIdxInMembers > -1;\n        const isSelected = userIdxInSelectedUsers > -1;\n\n        return (\n          <TouchableOpacity\n            activeOpacity={0.7}\n            disabled={isMember}\n            onPress={() => {\n              setSelectedUsers(([...draft]) => {\n                if (isSelected) draft.splice(userIdxInSelectedUsers, 1);\n                else draft.push(user);\n                return draft;\n              });\n            }}\n          >\n            <UserSelectableBar\n              uri={(user as unknown as SendbirdUser).profileUrl}\n              name={(user as unknown as SendbirdUser).nickname || STRINGS.LABELS.USER_NO_NAME}\n              selected={isMember || isSelected}\n              disabled={isMember}\n            />\n          </TouchableOpacity>\n        );\n      },\n      [channel, renderUser, queryCreator],\n    );\n\n    return (\n      <UserListModule.Provider\n        headerRight={(selectedUsers) => STRINGS.GROUP_CHANNEL_INVITE.HEADER_RIGHT({ selectedUsers })}\n        headerTitle={STRINGS.GROUP_CHANNEL_INVITE.HEADER_TITLE}\n      >\n        <UserListModule.Header\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={async (users) => {\n            const userIds = users.map((it) => it.userId);\n            const updatedChannel = await channel.inviteWithUserIds(userIds);\n            onInviteMembers(updatedChannel);\n          }}\n        />\n        <StatusComposition\n          loading={loading}\n          error={Boolean(error)}\n          LoadingComponent={<UserListModule.StatusLoading />}\n          ErrorComponent={<UserListModule.StatusError onPressRetry={() => refresh()} />}\n        >\n          <UserListModule.List\n            onLoadNext={next}\n            users={users}\n            renderUser={_renderUser}\n            onRefresh={refresh}\n            refreshing={refreshing}\n            ListEmptyComponent={<UserListModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </UserListModule.Provider>\n    );\n  };\n};\n\nfunction shouldFilterMember(channel: SendbirdGroupChannel) {\n  return !channel.isSuper && !channel.isBroadcast;\n}\n\nexport default createGroupChannelInviteFragment;\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,uBAAA,CAAAC,OAAA;AACA,IAAAC,YAAA,GAAAD,OAAA;AAEA,IAAAE,eAAA,GAAAF,OAAA;AAGA,IAAAG,kBAAA,GAAAC,sBAAA,CAAAJ,OAAA;AACA,IAAAK,kBAAA,GAAAD,sBAAA,CAAAJ,OAAA;AAEA,IAAAM,qBAAA,GAAAF,sBAAA,CAAAJ,OAAA;AAEA,IAAAO,WAAA,GAAAP,OAAA;AAAuE,SAAAI,uBAAAI,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAAA,SAAAG,yBAAAC,WAAA,eAAAC,OAAA,kCAAAC,iBAAA,OAAAD,OAAA,QAAAE,gBAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,WAAA,WAAAA,WAAA,GAAAG,gBAAA,GAAAD,iBAAA,KAAAF,WAAA;AAAA,SAAAb,wBAAAS,GAAA,EAAAI,WAAA,SAAAA,WAAA,IAAAJ,GAAA,IAAAA,GAAA,CAAAC,UAAA,WAAAD,GAAA,QAAAA,GAAA,oBAAAA,GAAA,wBAAAA,GAAA,4BAAAE,OAAA,EAAAF,GAAA,UAAAQ,KAAA,GAAAL,wBAAA,CAAAC,WAAA,OAAAI,KAAA,IAAAA,KAAA,CAAAC,GAAA,CAAAT,GAAA,YAAAQ,KAAA,CAAAE,GAAA,CAAAV,GAAA,SAAAW,MAAA,WAAAC,qBAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,GAAA,IAAAhB,GAAA,QAAAgB,GAAA,kBAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAnB,GAAA,EAAAgB,GAAA,SAAAI,IAAA,GAAAR,qBAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAf,GAAA,EAAAgB,GAAA,cAAAI,IAAA,KAAAA,IAAA,CAAAV,GAAA,IAAAU,IAAA,CAAAC,GAAA,KAAAR,MAAA,CAAAC,cAAA,CAAAH,MAAA,EAAAK,GAAA,EAAAI,IAAA,YAAAT,MAAA,CAAAK,GAAA,IAAAhB,GAAA,CAAAgB,GAAA,SAAAL,MAAA,CAAAT,OAAA,GAAAF,GAAA,MAAAQ,KAAA,IAAAA,KAAA,CAAAa,GAAA,CAAArB,GAAA,EAAAW,MAAA,YAAAA,MAAA;AAEvE,MAAMW,gCAAgC,GACpCC,UAA8C,IACL;EACzC,MAAMC,cAAc,GAAG,IAAAC,6BAAoB,EAAWF,UAAU,CAAC;EAEjE,OAAOG,IAAA,IAA+F;IAAA,IAA9F;MAAEC,OAAO;MAAEC,iBAAiB;MAAEC,eAAe;MAAEC,cAAc;MAAEC,YAAY;MAAEC;IAAW,CAAC,GAAAN,IAAA;IAC/F,MAAM;MAAEO;IAAI,CAAC,GAAG,IAAAC,2BAAe,GAAE;IACjC,MAAM;MAAEC;IAAQ,CAAC,GAAG,IAAAC,2BAAe,GAAE;IACrC,MAAM;MAAEC,KAAK;MAAEC,UAAU;MAAEC,OAAO;MAAEC,IAAI;MAAEC,KAAK;MAAEC;IAAQ,CAAC,GAAG,IAAAC,2BAAW,EAACV,GAAG,EAAE;MAC5EF,YAAY;MACZD;IACF,CAAC,CAAC;IAEF,MAAMc,SAAS,GAAGC,kBAAkB,CAAClB,OAAO,CAAC,GAAGA,OAAO,CAACmB,OAAO,CAACC,GAAG,CAAEC,EAAE,IAAKA,EAAE,CAACC,MAAM,CAAC,GAAG,EAAE;IAE3F,MAAMC,WAA2C,GAAG,IAAAC,kBAAW,EAC7D,CAACC,IAAI,EAAEC,aAAa,EAAEC,gBAAgB,KAAK;MACzC,IAAIvB,YAAY,IAAI,CAACC,UAAU,EAAE;QAC/B,MAAMuB,cAAc,GAAG,YAAY,IAAIH,IAAI,IAAI,UAAU,IAAIA,IAAI;QACjE,IAAI,CAACG,cAAc,EAAE,MAAM,IAAIC,KAAK,CAAC,+DAA+D,CAAC;MACvG;MAEA,IAAIxB,UAAU,EAAE,OAAOA,UAAU,CAACoB,IAAI,EAAEC,aAAa,EAAEC,gBAAgB,CAAC;MAExE,MAAMG,gBAAgB,GAAGb,SAAS,CAACc,OAAO,CAACN,IAAI,CAACH,MAAM,CAAC;MACvD,MAAMU,sBAAsB,GAAGN,aAAa,CAACO,SAAS,CAAEZ,EAAE,IAAKA,EAAE,CAACC,MAAM,KAAKG,IAAI,CAACH,MAAM,CAAC;MAEzF,MAAMY,QAAQ,GAAGJ,gBAAgB,GAAG,CAAC,CAAC;MACtC,MAAMK,UAAU,GAAGH,sBAAsB,GAAG,CAAC,CAAC;MAE9C,oBACErE,MAAA,CAAAY,OAAA,CAAA6D,aAAA,CAACtE,YAAA,CAAAuE,gBAAgB;QACfC,aAAa,EAAE,GAAI;QACnBC,QAAQ,EAAEL,QAAS;QACnBM,OAAO,EAAEA,CAAA,KAAM;UACbb,gBAAgB,CAACc,KAAA,IAAgB;YAAA,IAAf,CAAC,GAAGC,KAAK,CAAC,GAAAD,KAAA;YAC1B,IAAIN,UAAU,EAAEO,KAAK,CAACC,MAAM,CAACX,sBAAsB,EAAE,CAAC,CAAC,CAAC,KACnDU,KAAK,CAACE,IAAI,CAACnB,IAAI,CAAC;YACrB,OAAOiB,KAAK;UACd,CAAC,CAAC;QACJ;MAAE,gBAEF/E,MAAA,CAAAY,OAAA,CAAA6D,aAAA,CAAClE,kBAAA,CAAAK,OAAiB;QAChBsE,GAAG,EAAGpB,IAAI,CAA6BqB,UAAW;QAClDC,IAAI,EAAGtB,IAAI,CAA6BuB,QAAQ,IAAIxC,OAAO,CAACyC,MAAM,CAACC,YAAa;QAChFC,QAAQ,EAAEjB,QAAQ,IAAIC,UAAW;QACjCI,QAAQ,EAAEL;MAAS,EACnB,CACe;IAEvB,CAAC,EACD,CAAClC,OAAO,EAAEK,UAAU,EAAED,YAAY,CAAC,CACpC;IAED,oBACEzC,MAAA,CAAAY,OAAA,CAAA6D,aAAA,CAACvC,cAAc,CAACuD,QAAQ;MACtBC,WAAW,EAAG3B,aAAa,IAAKlB,OAAO,CAAC8C,oBAAoB,CAACC,YAAY,CAAC;QAAE7B;MAAc,CAAC,CAAE;MAC7F8B,WAAW,EAAEhD,OAAO,CAAC8C,oBAAoB,CAACG;IAAa,gBAEvD9F,MAAA,CAAAY,OAAA,CAAA6D,aAAA,CAACvC,cAAc,CAAC6D,MAAM;MACpBzD,iBAAiB,EAAEA,iBAAkB;MACrC0D,kBAAkB,EAAE,MAAOjD,KAAK,IAAK;QACnC,MAAMkD,OAAO,GAAGlD,KAAK,CAACU,GAAG,CAAEC,EAAE,IAAKA,EAAE,CAACC,MAAM,CAAC;QAC5C,MAAMuC,cAAc,GAAG,MAAM7D,OAAO,CAAC8D,iBAAiB,CAACF,OAAO,CAAC;QAC/D1D,eAAe,CAAC2D,cAAc,CAAC;MACjC;IAAE,EACF,eACFlG,MAAA,CAAAY,OAAA,CAAA6D,aAAA,CAACpE,kBAAA,CAAAO,OAAiB;MAChBwC,OAAO,EAAEA,OAAQ;MACjBD,KAAK,EAAEiD,OAAO,CAACjD,KAAK,CAAE;MACtBkD,gBAAgB,eAAErG,MAAA,CAAAY,OAAA,CAAA6D,aAAA,CAACvC,cAAc,CAACoE,aAAa,OAAI;MACnDC,cAAc,eAAEvG,MAAA,CAAAY,OAAA,CAAA6D,aAAA,CAACvC,cAAc,CAACsE,WAAW;QAACC,YAAY,EAAEA,CAAA,KAAMxD,OAAO;MAAG;IAAI,gBAE9EjD,MAAA,CAAAY,OAAA,CAAA6D,aAAA,CAACvC,cAAc,CAACwE,IAAI;MAClBC,UAAU,EAAEzD,IAAK;MACjBH,KAAK,EAAEA,KAAM;MACbL,UAAU,EAAEkB,WAAY;MACxBgD,SAAS,EAAE3D,OAAQ;MACnBD,UAAU,EAAEA,UAAW;MACvB6D,kBAAkB,eAAE7G,MAAA,CAAAY,OAAA,CAAA6D,aAAA,CAACvC,cAAc,CAAC4E,WAAW;IAAI,EACnD,CACgB,CACI;EAE9B,CAAC;AACH,CAAC;AAED,SAASvD,kBAAkBA,CAAClB,OAA6B,EAAE;EACzD,OAAO,CAACA,OAAO,CAAC0E,OAAO,IAAI,CAAC1E,OAAO,CAAC2E,WAAW;AACjD;AAAC,IAAAC,QAAA,GAEcjF,gCAAgC;AAAAkF,OAAA,CAAAtG,OAAA,GAAAqG,QAAA"}